<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CiteFuse: getting start â€¢ CiteFuse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="CiteFuse: getting start">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CiteFuse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Getting start
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CiteFuse.html">Getting start with CiteFuse</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SydneyBioX/CiteFuse">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="CiteFuse_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="CiteFuse_files/jquery-1.12.4/jquery.min.js"></script><link href="CiteFuse_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="CiteFuse_files/datatables-binding-0.10/datatables.js"></script><link href="CiteFuse_files/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="CiteFuse_files/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="CiteFuse_files/dt-core-1.10.19/js/jquery.dataTables.min.js"></script><link href="CiteFuse_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
<script src="CiteFuse_files/crosstalk-1.0.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>CiteFuse: getting start</h1>
            
      
      
      <div class="hidden name"><code>CiteFuse.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>CiteFuse</code> is a computational framework that implements a suite of methods and tools for CITE-seq data from pre-processing through to integrative analytics. This includes doublet detection, network-based modality integration, cell type clustering, differential RNA and ADT expression analysis, ADT evaluation, ligand-receptor interaction analysis, and interactive web-based visualisation of the analyses. this vignette demostrates the usage of <code>CiteFuse</code> using a small subset data of CITE-seq data from PBMC as an example (Mimitou et al., 2019).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(CiteFuse)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(scater)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(SingleCellExperiment)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DT)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"CITEseq_example"</span>, <span class="dt">package =</span> <span class="st">"CiteFuse"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(CITEseq_example)</a></code></pre></div>
<pre><code>## [1] "RNA" "ADT" "HTO"</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(CITEseq_example, dim)</a></code></pre></div>
<pre><code>## $RNA
## [1] 19521   500
## 
## $ADT
## [1]  49 500
## 
## $HTO
## [1]   4 500</code></pre>
<p>Here, we started from a list of three matrices of RNA, ADT and HTO, which have common cell names. The <code>preprocessing</code> function will utilise the three matrices and its common cell names to create a <code>SingleCellExperiment</code> object, which stores RNA data in <code>assay</code>, and <code>ADT</code>, <code>HTO</code> data in <code>altExp</code> slot.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/preprocessing.html">preprocessing</a></span>(CITEseq_example)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">sce_citeseq</a></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 19521 500 
## metadata(0):
## assays(1): counts
## rownames(19521): hg19_AL627309.1 hg19_AL669831.5 ... hg19_MT-ND6
##   hg19_MT-CYB
## rowData names(0):
## colnames(500): AAGCCGCGTTGTCTTT GATCGCGGTTATCGGT ... TTGGCAACACTAGTAC
##   GCTGCGAGTTGTGGCC
## colData names(0):
## reducedDimNames(0):
## spikeNames(0):
## altExpNames(2): ADT HTO</code></pre>
</div>
<div id="detecting-both-cross--and-within-sample-doublets-using-citefuse" class="section level1">
<h1 class="hasAnchor">
<a href="#detecting-both-cross--and-within-sample-doublets-using-citefuse" class="anchor"></a>Detecting both cross- and within-sample doublets using <code>CiteFuse</code>
</h1>
<div id="hto-normalisation-and-visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#hto-normalisation-and-visualisation" class="anchor"></a>HTO Normalisation and Visualisation</h2>
<p>The function <code>notmaliseExprs</code> is used to scale the alternative expression. Here, we used it to perform log-transformation for the <code>HTO</code> expression, by setting <code>transform = "log"</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(<span class="dt">sce =</span> sce_citeseq, </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                              <span class="dt">altExp_name =</span> <span class="st">"HTO"</span>, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">                              <span class="dt">transform =</span> <span class="st">"log"</span>)</a></code></pre></div>
<p>Then we can perform dimension reduction on the <code>HTO</code> expression using <code>runTSNE</code> or <code>runUMAP</code>, then use <code>visualiseDim</code> function to visualise the reduced dimension plot.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span>scater<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/scater/man/runTSNE.html">runTSNE</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                               <span class="dt">altexp =</span> <span class="st">"HTO"</span>, </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                               <span class="dt">name =</span> <span class="st">"TSNE_HTO"</span>, </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                               <span class="dt">pca =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">             <span class="dt">dimNames =</span> <span class="st">"TSNE_HTO"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"tSNE (HTO)"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span>scater<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/scater/man/runUMAP.html">runUMAP</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb10-2" data-line-number="2">                               <span class="dt">altexp =</span> <span class="st">"HTO"</span>, </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                               <span class="dt">name =</span> <span class="st">"UMAP_HTO"</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">             <span class="dt">dimNames =</span> <span class="st">"UMAP_HTO"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"UMAP (HTO)"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-5-2.png" width="576"></p>
</div>
<div id="doublet-identification-cross-sample" class="section level2">
<h2 class="hasAnchor">
<a href="#doublet-identification-cross-sample" class="anchor"></a>Doublet Identification (cross sample)</h2>
<p>We first identify the cross-sample doublets via function <code>crossSampleDoublets</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/crossSampleDoublets.html">crossSampleDoublets</a></span>(sce_citeseq)</a></code></pre></div>
<pre><code>## number of iterations= 20 
## number of iterations= 24 
## number of iterations= 46 
## number of iterations= 50</code></pre>
<p>The results of the cross sample doublets are then saved in the <code>colData</code> as <code>doubletClassify_between_label</code> and <code>doubletClassify_between_class</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(sce_citeseq<span class="op">$</span>doubletClassify_between_label)</a></code></pre></div>
<pre><code>## 
##                 1                 2                 3                 4 
##               115               121                92               129 
## doublet/multiplet 
##                43</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(sce_citeseq<span class="op">$</span>doubletClassify_between_class)</a></code></pre></div>
<pre><code>## 
## doublet/multiplet           Singlet 
##                43               457</code></pre>
<p>We can then highlights the cross-sample doublets in our tSNE plot of HTO expression.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb17-2" data-line-number="2">             <span class="dt">dimNames =</span> <span class="st">"TSNE_HTO"</span>, </a>
<a class="sourceLine" id="cb17-3" data-line-number="3">             <span class="dt">colour_by =</span> <span class="st">"doubletClassify_between_label"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>Further, <code>plotHTO</code> function allows us to plot the pairwise scatter HTO expression.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="../reference/plotHTO.html">plotHTO</a></span>(sce_citeseq, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
</div>
<div id="doublet-identification-within-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#doublet-identification-within-samples" class="anchor"></a>Doublet Identification (within samples)</h2>
<p>We then identify the within-sample doublets via function <code>withinSampleDoublets</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/withinSampleDoublets.html">withinSampleDoublets</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">                                    <span class="dt">minPts =</span> <span class="dv">10</span>)</a></code></pre></div>
<p>The results of the cross sample doublets are then saved in the <code>colData</code> as <code>doubletClassify_within_label</code> and <code>doubletClassify_within_class</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(sce_citeseq<span class="op">$</span>doubletClassify_within_label)</a></code></pre></div>
<pre><code>## 
##  Doublets(Within)_1  Doublets(Within)_2  Doublets(Within)_3  Doublets(Within)_4 
##                   3                   7                   4                   6 
## NotDoublets(Within) 
##                 480</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(sce_citeseq<span class="op">$</span>doubletClassify_within_class)</a></code></pre></div>
<pre><code>## 
## Doublet Singlet 
##      20     480</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb24-2" data-line-number="2">             <span class="dt">dimNames =</span> <span class="st">"TSNE_HTO"</span>, </a>
<a class="sourceLine" id="cb24-3" data-line-number="3">             <span class="dt">colour_by =</span> <span class="st">"doubletClassify_within_label"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
<p>Finally, we can filter out the doublets cells (Both within and between batches) for the downstream analysis.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span>sce_citeseq[, sce_citeseq<span class="op">$</span>doubletClassify_within_class <span class="op">==</span><span class="st"> "Singlet"</span> <span class="op">&amp;</span><span class="st"> </span>sce_citeseq<span class="op">$</span>doubletClassify_between_class <span class="op">==</span><span class="st"> "Singlet"</span>]</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">sce_citeseq</a></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 19521 437 
## metadata(3): doubletClassify_between_threshold
##   doubletClassify_between_resultsMat doubletClassify_within_resultsMat
## assays(1): counts
## rownames(19521): hg19_AL627309.1 hg19_AL669831.5 ... hg19_MT-ND6
##   hg19_MT-CYB
## rowData names(0):
## colnames(437): GATCGCGGTTATCGGT GGCTGGTAGAGGTTAT ... TTGGCAACACTAGTAC
##   GCTGCGAGTTGTGGCC
## colData names(5): doubletClassify_between_label
##   doubletClassify_between_class nUMI doubletClassify_within_label
##   doubletClassify_within_class
## reducedDimNames(2): TSNE_HTO UMAP_HTO
## spikeNames(0):
## altExpNames(2): ADT HTO</code></pre>
</div>
</div>
<div id="clustering" class="section level1">
<h1 class="hasAnchor">
<a href="#clustering" class="anchor"></a>Clustering</h1>
<div id="performing-snf" class="section level2">
<h2 class="hasAnchor">
<a href="#performing-snf" class="anchor"></a>Performing SNF</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span>scater<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(sce_citeseq)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CiteFuse.html">CiteFuse</a></span>(sce_citeseq))</a></code></pre></div>
<pre><code>## Calculating affinity matrix 
## Performing SNF</code></pre>
<pre><code>##    user  system elapsed 
##   2.385   0.150   2.535</code></pre>
</div>
<div id="performing-spectral-clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#performing-spectral-clustering" class="anchor"></a>Performing spectral clustering</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">SNF_W_clust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"SNF_W"</span>]], <span class="dt">K =</span> <span class="dv">20</span>)</a></code></pre></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 20 dimensions</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(SNF_W_clust<span class="op">$</span>eigen_values)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(SNF_W_clust<span class="op">$</span>eigen_values)))</a></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">SNF_W_clust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"SNF_W"</span>]], <span class="dt">K =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">sce_citeseq<span class="op">$</span>SNF_W_clust &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(SNF_W_clust<span class="op">$</span>labels)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"></a>
<a class="sourceLine" id="cb37-5" data-line-number="5">SNF_W1_clust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"ADT_W"</span>]], <span class="dt">K =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">sce_citeseq<span class="op">$</span>ADT_clust &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(SNF_W1_clust<span class="op">$</span>labels)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"></a>
<a class="sourceLine" id="cb39-3" data-line-number="3">SNF_W2_clust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"RNA_W"</span>]], <span class="dt">K =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">sce_citeseq<span class="op">$</span>RNA_clust &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(SNF_W2_clust<span class="op">$</span>labels)</a></code></pre></div>
</div>
<div id="visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#visualisation" class="anchor"></a>Visualisation</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/reducedDimSNF.html">reducedDimSNF</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb42-2" data-line-number="2">                             <span class="dt">method =</span> <span class="st">"tSNE"</span>, </a>
<a class="sourceLine" id="cb42-3" data-line-number="3">                             <span class="dt">dimNames =</span> <span class="st">"tSNE_joint"</span>)</a>
<a class="sourceLine" id="cb42-4" data-line-number="4"></a>
<a class="sourceLine" id="cb42-5" data-line-number="5">g1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, <span class="dt">dimNames =</span> <span class="st">"tSNE_joint"</span>, <span class="dt">colour_by =</span> <span class="st">"SNF_W_clust"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"tSNE (SNF clustering)"</span>)</a>
<a class="sourceLine" id="cb42-7" data-line-number="7">g2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, <span class="dt">dimNames =</span> <span class="st">"tSNE_joint"</span>,  <span class="dt">colour_by =</span> <span class="st">"ADT_clust"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"tSNE (ADT clustering)"</span>)</a>
<a class="sourceLine" id="cb42-9" data-line-number="9">g3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, <span class="dt">dimNames =</span> <span class="st">"tSNE_joint"</span>,  <span class="dt">colour_by =</span> <span class="st">"RNA_clust"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"tSNE (RNA clustering)"</span>)</a>
<a class="sourceLine" id="cb42-11" data-line-number="11"></a>
<a class="sourceLine" id="cb42-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gridExtra)</a>
<a class="sourceLine" id="cb42-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(g3, g2, g1, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-16-1.png" width="768"></p>
</div>
<div id="louvain-clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#louvain-clustering" class="anchor"></a>Louvain Clustering</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">SNF_W_louvain &lt;-<span class="st"> </span><span class="kw"><a href="../reference/igraphClustering.html">igraphClustering</a></span>(sce_citeseq, <span class="dt">method =</span> <span class="st">"louvain"</span>)</a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(SNF_W_louvain)</a></code></pre></div>
<pre><code>## SNF_W_louvain
##  1  2  3  4  5  6  7  8  9 
## 30 38 80 29 90 37 52 29 52</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">sce_citeseq<span class="op">$</span>SNF_W_louvain &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(SNF_W_louvain)</a>
<a class="sourceLine" id="cb45-2" data-line-number="2"></a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, <span class="dt">dimNames =</span> <span class="st">"tSNE_joint"</span>, <span class="dt">colour_by =</span> <span class="st">"SNF_W_louvain"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"tSNE (SNF louvain clustering)"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseKNN.html">visualiseKNN</a></span>(sce_citeseq, <span class="dt">colour_by =</span> <span class="st">"SNF_W_louvain"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-18-1.png" width="576"></p>
</div>
</div>
<div id="differential-expression-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#differential-expression-analysis" class="anchor"></a>Differential Expression Analysis</h1>
<div id="exploration-of-features-expression" class="section level2">
<h2 class="hasAnchor">
<a href="#exploration-of-features-expression" class="anchor"></a>Exploration of features expression</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb47-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"boxplot"</span>, </a>
<a class="sourceLine" id="cb47-3" data-line-number="3">               <span class="dt">group_by =</span> <span class="st">"SNF_W_louvain"</span>,</a>
<a class="sourceLine" id="cb47-4" data-line-number="4">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-19-1.png" width="768"></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb48-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"violin"</span>, </a>
<a class="sourceLine" id="cb48-3" data-line-number="3">               <span class="dt">group_by =</span> <span class="st">"SNF_W_louvain"</span>,</a>
<a class="sourceLine" id="cb48-4" data-line-number="4">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-19-2.png" width="768"></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb49-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"jitter"</span>, </a>
<a class="sourceLine" id="cb49-3" data-line-number="3">               <span class="dt">group_by =</span> <span class="st">"SNF_W_louvain"</span>,</a>
<a class="sourceLine" id="cb49-4" data-line-number="4">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-19-3.png" width="768"></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb50-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"density"</span>, </a>
<a class="sourceLine" id="cb50-3" data-line-number="3">               <span class="dt">group_by =</span> <span class="st">"SNF_W_louvain"</span>,</a>
<a class="sourceLine" id="cb50-4" data-line-number="4">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-19-4.png" width="768"></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, <span class="dt">transform =</span> <span class="st">"log"</span>)</a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb51-3" data-line-number="3">               <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb51-4" data-line-number="4">               <span class="dt">n =</span> <span class="dv">30</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb51-5" data-line-number="5"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-20-1.png" width="768"></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb52-2" data-line-number="2">               <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb52-3" data-line-number="3">               <span class="dt">group_by =</span> <span class="st">"SNF_W_louvain"</span>,</a>
<a class="sourceLine" id="cb52-4" data-line-number="4">               <span class="dt">plot =</span> <span class="st">"violin"</span>, <span class="dt">n =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-21-1.png" width="768"></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb53-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"jitter"</span>, </a>
<a class="sourceLine" id="cb53-3" data-line-number="3">               <span class="dt">group_by =</span> <span class="st">"SNF_W_louvain"</span>, </a>
<a class="sourceLine" id="cb53-4" data-line-number="4">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD2"</span>, <span class="st">"CD8"</span>, <span class="st">"CD4"</span>, <span class="st">"CD19"</span>))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-21-2.png" width="768"></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb54-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"density"</span>, </a>
<a class="sourceLine" id="cb54-3" data-line-number="3">               <span class="dt">group_by =</span> <span class="st">"SNF_W_louvain"</span>,</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD2"</span>, <span class="st">"CD8"</span>, <span class="st">"CD4"</span>, <span class="st">"CD19"</span>))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-21-3.png" width="768"></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb55-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"pairwise"</span>, </a>
<a class="sourceLine" id="cb55-3" data-line-number="3">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD4"</span>, <span class="st">"CD8"</span>))</a></code></pre></div>
<pre><code>## number of iterations= 10 
## number of iterations= 18</code></pre>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-22-1.png" width="768"></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb57-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"pairwise"</span>, </a>
<a class="sourceLine" id="cb57-3" data-line-number="3">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD45RA"</span>, <span class="st">"CD4"</span>, <span class="st">"CD8"</span>), <span class="dt">threshold =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">4</span>, <span class="dv">3</span>))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-22-2.png" width="768"></p>
</div>
<div id="perform-de-analysis-using-wilcoxon-rank-sum-test" class="section level2">
<h2 class="hasAnchor">
<a href="#perform-de-analysis-using-wilcoxon-rank-sum-test" class="anchor"></a>Perform DE analysis using Wilcoxon Rank Sum test</h2>
<div id="for-rna-expression" class="section level3">
<h3 class="hasAnchor">
<a href="#for-rna-expression" class="anchor"></a>For RNA expression</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="co"># DE will be performed for RNA if altExp_name = "none" </span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/DEgenes.html">DEgenes</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb58-3" data-line-number="3">                       <span class="dt">altExp_name =</span> <span class="st">"none"</span>, </a>
<a class="sourceLine" id="cb58-4" data-line-number="4">                       <span class="dt">group =</span> sce_citeseq<span class="op">$</span>SNF_W_louvain,</a>
<a class="sourceLine" id="cb58-5" data-line-number="5">                       <span class="dt">return_all =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb58-6" data-line-number="6">                       <span class="dt">exprs_pct =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb58-7" data-line-number="7"></a>
<a class="sourceLine" id="cb58-8" data-line-number="8"></a>
<a class="sourceLine" id="cb58-9" data-line-number="9">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/selectDEgenes.html">selectDEgenes</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb58-10" data-line-number="10">                             <span class="dt">altExp_name =</span> <span class="st">"none"</span>)</a>
<a class="sourceLine" id="cb58-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(rbind, <span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"DE_res_RNA_filter"</span>]]), </a>
<a class="sourceLine" id="cb58-12" data-line-number="12">                 <span class="dt">digits =</span> <span class="dv">2</span>))</a></code></pre></div>
<div id="htmlwidget-30c7efb4003cbe979b37" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-30c7efb4003cbe979b37">{"x":{"filter":"none","data":[["1.hg19_GZMK","1.hg19_KLRB1","1.hg19_DUSP2","1.hg19_IL7R","1.hg19_NCR3","1.hg19_CEBPD","1.hg19_KLRG1","1.hg19_CD69","1.hg19_LINC01871","1.hg19_IL32","2.hg19_CD8B","2.hg19_CMC1","2.hg19_CCL5","2.hg19_CD8A","2.hg19_GZMM","2.hg19_DUSP2","2.hg19_NDUFA6","2.hg19_HCST","2.hg19_RNF166","2.hg19_FYN","3.hg19_ZNF683","3.hg19_TRBV20-1","3.hg19_CD8A","3.hg19_FGFBP2","3.hg19_GZMH","3.hg19_CD8B","3.hg19_CCL5","3.hg19_CST7","3.hg19_KLRD1","3.hg19_CYTOR","4.hg19_CCR7","4.hg19_ACTN1","4.hg19_NELL2","4.hg19_PASK","4.hg19_MAL","4.hg19_CD8B","4.hg19_LEF1","4.hg19_PIK3IP1","4.hg19_LDLRAP1","4.hg19_PCED1B","5.hg19_LTB","5.hg19_TCF7","5.hg19_IL7R","5.hg19_LDHB","5.hg19_INPP4B","5.hg19_CD27","5.hg19_LEF1","5.hg19_NOSIP","5.hg19_SELL","5.hg19_CAMK4","6.hg19_FCN1","6.hg19_LYZ","6.hg19_SPI1","6.hg19_CYBB","6.hg19_HLA-DRA","6.hg19_S100A9","6.hg19_CD68","6.hg19_S100A8","6.hg19_CSTA","6.hg19_VCAN","7.hg19_GNLY","7.hg19_CCL5","7.hg19_GZMB","7.hg19_CTSW","7.hg19_NKG7","7.hg19_GZMH","7.hg19_IFITM2","7.hg19_KLRD1","7.hg19_CD8A","7.hg19_TYROBP","8.hg19_IL7R","8.hg19_S100A4","8.hg19_S100A10","8.hg19_IL32","8.hg19_EML4","8.hg19_FAM107B","8.hg19_RORA","8.hg19_CD2","8.hg19_TNFAIP3","8.hg19_GUK1","9.hg19_SH2D1B","9.hg19_KLRF1","9.hg19_CLIC3","9.hg19_FCER1G","9.hg19_MYOM2","9.hg19_TRDC","9.hg19_SPON2","9.hg19_TYROBP","9.hg19_IL2RB","9.hg19_KLRB1"],["2668"," 850","2126","2159","3396","3393","2878","3109","3983","3478","3257","3984","3217","4004","4452","5063","5205","4890","5330","5168","4890","6321","4268","5222","5277","7670","6396","6720","7320","8196","2449","2815","2907","3163","3115","2175","2384","2787","3260","3524","3917","5592","5443","5736","9061","9080","8530","7904","8680","9426","2400","2406","2409","2600"," 661","2808","3200","2825","3400","3400","2545","3656","4591","5072","4800","5220","4839","5452","5463","6141","2602","3100","3253","3434","3973","4176","4256","4141","4160","4118","3603","2742","3449","3498","2047","4272","2804","2748","3121","3143"],["7.8e-24","2.5e-23","1.1e-11","1.2e-10","1.6e-10","3.2e-10","9.2e-09","2.5e-07","7.5e-06","7.6e-05","8.8e-14","9.8e-10","2.0e-09","1.6e-07","4.5e-06","1.1e-04","1.7e-04","2.7e-04","2.9e-04","3.3e-04","9.3e-43","8.1e-37","1.2e-26","9.8e-23","8.4e-22","9.8e-17","2.9e-15","2.9e-14","7.9e-14","1.5e-13","3.0e-21","3.7e-19","8.1e-19","1.6e-18","1.4e-13","2.8e-13","5.0e-13","5.0e-11","1.5e-10","2.7e-10","3.7e-34","2.4e-31","3.1e-25","7.1e-22","2.0e-19","3.8e-19","4.7e-19","2.3e-16","2.9e-15","1.0e-14","4.5e-64","1.1e-61","1.3e-61","1.9e-61","9.1e-60","2.2e-56","1.3e-53","4.7e-52","4.8e-51","4.8e-51","3.1e-19","2.9e-14","7.3e-12","1.9e-10","4.8e-10","1.1e-09","1.4e-09","5.1e-09","6.9e-09","7.8e-09","3.9e-08","1.8e-05","4.5e-05","1.5e-04","4.2e-04","2.8e-03","3.2e-03","3.9e-03","4.1e-03","4.6e-03","7.0e-52","3.7e-37","4.7e-34","1.4e-33","1.6e-33","6.8e-31","1.4e-27","2.3e-27","8.4e-26","3.1e-24"],["7.8e-24","2.5e-23","1.1e-11","1.2e-10","1.6e-10","3.2e-10","9.2e-09","2.5e-07","7.5e-06","7.6e-05","8.8e-14","9.8e-10","2.0e-09","1.6e-07","4.5e-06","1.1e-04","1.7e-04","2.7e-04","2.9e-04","3.3e-04","9.3e-43","8.1e-37","1.2e-26","9.8e-23","8.4e-22","9.8e-17","2.9e-15","2.9e-14","7.9e-14","1.5e-13","3.0e-21","3.7e-19","8.1e-19","1.6e-18","1.4e-13","2.8e-13","5.0e-13","5.0e-11","1.5e-10","2.7e-10","3.7e-34","2.4e-31","3.1e-25","7.1e-22","2.0e-19","3.8e-19","4.7e-19","2.3e-16","2.9e-15","1.0e-14","4.5e-64","1.1e-61","1.3e-61","1.9e-61","9.1e-60","2.2e-56","1.3e-53","4.7e-52","4.8e-51","4.8e-51","3.1e-19","2.9e-14","7.3e-12","1.9e-10","4.8e-10","1.1e-09","1.4e-09","5.1e-09","6.9e-09","7.8e-09","3.9e-08","1.8e-05","4.5e-05","1.5e-04","4.2e-04","2.8e-03","3.2e-03","3.9e-03","4.1e-03","4.6e-03","7.0e-52","3.7e-37","4.7e-34","1.4e-33","1.6e-33","6.8e-31","1.4e-27","2.3e-27","8.4e-26","3.1e-24"],["0.1088","0.4686","0.5104","0.9285","0.1657","0.2075","0.4686","0.4013","0.2302","1.7839","0.3541","0.4049","2.0103","0.8258","0.5960","0.5444","0.3662","1.3533","0.3648","0.5329","0.0920","0.1043","0.6408","0.6099","0.7164","0.3141","1.8257","1.3502","0.6572","0.2635","0.0890","0.0690","0.0740","0.0513","0.1080","0.3614","0.2537","0.2096","0.1353","0.0991","0.5608","0.2284","0.7299","0.7113","0.1061","0.1245","0.1797","0.3680","0.3325","0.1754","0.0000","0.0016","0.0027","0.0000","0.0529","0.0020","0.0000","0.0079","0.0000","0.0000","2.3480","1.9339","0.9406","0.6517","2.1203","0.8427","1.6395","0.7225","0.7999","0.5668","0.9520","2.3277","1.2842","1.7878","0.3654","0.4598","0.4339","0.6678","0.6590","0.7686","0.0184","0.1293","0.0921","0.1812","0.2495","0.0941","0.2766","0.4647","0.2215","0.4411"],["0.92","2.80","1.69","2.53","0.81","0.94","1.28","1.07","0.69","2.67","1.36","1.44","3.78","1.75","1.23","1.09","0.77","1.96","0.77","0.99","1.15","1.49","2.09","1.93","2.07","1.01","3.67","2.64","1.56","0.92","0.82","0.65","0.56","0.51","0.60","1.57","1.09","0.86","0.66","0.46","2.36","1.19","2.23","1.79","0.63","0.60","0.81","1.06","1.03","0.64","1.83","2.74","1.14","0.81","2.84","2.53","0.74","2.81","1.04","1.50","5.13","3.87","2.19","1.52","3.88","1.87","2.54","1.56","1.69","1.36","2.26","3.32","2.00","2.65","0.85","0.80","0.82","1.07","1.17","1.14","0.91","1.22","1.42","1.71","1.81","0.96","1.78","2.11","1.34","2.02"],["0.0565","0.2285","0.3489","0.4251","0.1278","0.1351","0.2998","0.3464","0.1843","0.7617","0.2206","0.2431","0.6140","0.4185","0.4286","0.3609","0.3283","0.7569","0.3058","0.4110","0.0616","0.0448","0.3529","0.3305","0.3585","0.1793","0.5686","0.5490","0.3641","0.2297","0.0784","0.0686","0.0637","0.0515","0.0931","0.2304","0.1985","0.1838","0.1275","0.0980","0.2911","0.1671","0.3314","0.5072","0.1037","0.1037","0.1441","0.3055","0.2248","0.1585","0.0000","0.0025","0.0025","0.0000","0.0450","0.0025","0.0000","0.0075","0.0000","0.0000","0.5792","0.6000","0.4156","0.3844","0.6052","0.4078","0.8312","0.3974","0.4078","0.2208","0.4265","0.8946","0.7451","0.7672","0.3137","0.3824","0.3382","0.4853","0.4755","0.5784","0.0130","0.0935","0.0831","0.0779","0.1766","0.0597","0.1896","0.1818","0.1844","0.2000"],["0.63","0.97","0.90","0.93","0.57","0.57","0.83","0.77","0.53","1.00","0.76","0.66","1.00","0.89","0.76","0.66","0.55","0.92","0.55","0.66","0.71","0.60","0.94","0.89","0.93","0.66","1.00","0.99","0.82","0.59","0.66","0.59","0.59","0.52","0.59","0.79","0.76","0.72","0.55","0.52","0.93","0.79","0.96","0.87","0.51","0.52","0.59","0.72","0.66","0.56","0.68","0.68","0.68","0.65","0.92","0.62","0.57","0.62","0.54","0.54","1.00","1.00","0.92","0.83","1.00","0.87","0.98","0.83","0.85","0.65","0.93","1.00","0.97","0.93","0.59","0.62","0.59","0.72","0.69","0.79","0.65","0.81","0.69","0.73","0.88","0.63","0.81","0.94","0.79","0.87"],["0.58","0.74","0.55","0.51","0.44","0.43","0.53","0.42","0.35","0.24","0.54","0.41","0.39","0.48","0.33","0.30","0.22","0.16","0.25","0.25","0.65","0.56","0.58","0.56","0.57","0.48","0.43","0.44","0.46","0.36","0.58","0.52","0.52","0.47","0.49","0.56","0.56","0.54","0.42","0.42","0.64","0.62","0.62","0.36","0.41","0.42","0.44","0.42","0.43","0.40","0.68","0.67","0.67","0.65","0.87","0.62","0.57","0.61","0.54","0.54","0.42","0.40","0.51","0.44","0.39","0.46","0.15","0.43","0.44","0.43","0.50","0.11","0.22","0.16","0.27","0.24","0.25","0.24","0.21","0.21","0.64","0.71","0.61","0.65","0.71","0.57","0.62","0.76","0.60","0.67"],["0.58","0.74","0.55","0.51","0.44","0.43","0.53","0.42","0.35","0.24","0.54","0.41","0.39","0.48","0.33","0.30","0.22","0.16","0.25","0.25","0.65","0.56","0.58","0.56","0.57","0.48","0.43","0.44","0.46","0.36","0.58","0.52","0.52","0.47","0.49","0.56","0.56","0.54","0.42","0.42","0.64","0.62","0.62","0.36","0.41","0.42","0.44","0.42","0.43","0.40","0.68","0.67","0.67","0.65","0.87","0.62","0.57","0.61","0.54","0.54","0.42","0.40","0.51","0.44","0.39","0.46","0.15","0.43","0.44","0.43","0.50","0.11","0.22","0.16","0.27","0.24","0.25","0.24","0.21","0.21","0.64","0.71","0.61","0.65","0.71","0.57","0.62","0.76","0.60","0.67"],["hg19_GZMK","hg19_KLRB1","hg19_DUSP2","hg19_IL7R","hg19_NCR3","hg19_CEBPD","hg19_KLRG1","hg19_CD69","hg19_LINC01871","hg19_IL32","hg19_CD8B","hg19_CMC1","hg19_CCL5","hg19_CD8A","hg19_GZMM","hg19_DUSP2","hg19_NDUFA6","hg19_HCST","hg19_RNF166","hg19_FYN","hg19_ZNF683","hg19_TRBV20-1","hg19_CD8A","hg19_FGFBP2","hg19_GZMH","hg19_CD8B","hg19_CCL5","hg19_CST7","hg19_KLRD1","hg19_CYTOR","hg19_CCR7","hg19_ACTN1","hg19_NELL2","hg19_PASK","hg19_MAL","hg19_CD8B","hg19_LEF1","hg19_PIK3IP1","hg19_LDLRAP1","hg19_PCED1B","hg19_LTB","hg19_TCF7","hg19_IL7R","hg19_LDHB","hg19_INPP4B","hg19_CD27","hg19_LEF1","hg19_NOSIP","hg19_SELL","hg19_CAMK4","hg19_FCN1","hg19_LYZ","hg19_SPI1","hg19_CYBB","hg19_HLA-DRA","hg19_S100A9","hg19_CD68","hg19_S100A8","hg19_CSTA","hg19_VCAN","hg19_GNLY","hg19_CCL5","hg19_GZMB","hg19_CTSW","hg19_NKG7","hg19_GZMH","hg19_IFITM2","hg19_KLRD1","hg19_CD8A","hg19_TYROBP","hg19_IL7R","hg19_S100A4","hg19_S100A10","hg19_IL32","hg19_EML4","hg19_FAM107B","hg19_RORA","hg19_CD2","hg19_TNFAIP3","hg19_GUK1","hg19_SH2D1B","hg19_KLRF1","hg19_CLIC3","hg19_FCER1G","hg19_MYOM2","hg19_TRDC","hg19_SPON2","hg19_TYROBP","hg19_IL2RB","hg19_KLRB1"],["1","1","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","2","3","3","3","3","3","3","3","3","3","3","4","4","4","4","4","4","4","4","4","4","5","5","5","5","5","5","5","5","5","5","6","6","6","6","6","6","6","6","6","6","7","7","7","7","7","7","7","7","7","7","8","8","8","8","8","8","8","8","8","8","9","9","9","9","9","9","9","9","9","9"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>stats.W<\/th>\n      <th>pval<\/th>\n      <th>p.adjust<\/th>\n      <th>meanExprs.1<\/th>\n      <th>meanExprs.2<\/th>\n      <th>meanPct.1<\/th>\n      <th>meanPct.2<\/th>\n      <th>meanDiff<\/th>\n      <th>pctDiff<\/th>\n      <th>name<\/th>\n      <th>group<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="for-adt" class="section level3">
<h3 class="hasAnchor">
<a href="#for-adt" class="anchor"></a>For ADT</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/DEgenes.html">DEgenes</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb59-2" data-line-number="2">                       <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb59-3" data-line-number="3">                       <span class="dt">group =</span> sce_citeseq<span class="op">$</span>SNF_W_louvain,</a>
<a class="sourceLine" id="cb59-4" data-line-number="4">                       <span class="dt">return_all =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb59-5" data-line-number="5">                       <span class="dt">exprs_pct =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb59-6" data-line-number="6"></a>
<a class="sourceLine" id="cb59-7" data-line-number="7"></a>
<a class="sourceLine" id="cb59-8" data-line-number="8">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/selectDEgenes.html">selectDEgenes</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb59-9" data-line-number="9">                             <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>)</a>
<a class="sourceLine" id="cb59-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(rbind, <span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"DE_res_ADT_filter"</span>]]), </a>
<a class="sourceLine" id="cb59-11" data-line-number="11">                 <span class="dt">digits =</span> <span class="dv">2</span>))</a></code></pre></div>
<div id="htmlwidget-22510e0838f714628f2d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-22510e0838f714628f2d">{"x":{"filter":"none","data":[["1.CD26 (Adenosine)","1.CD28","4","5.CD28","5.CD26 (Adenosine)","5.CD3","6.LAMP1","6.CD45RO","6.CD45","6.B220 (CD45R)","6.CD14","6.B7-H1 (PD-L1)","6.Siglec-8","6.PD-L1 (CD274)","6.TCRg","6.EpCAM (CD326)","9"],[" 2830"," 3124"," 4549"," 4114","10836","10830"," 1652"," 1660"," 2274"," 2366"," 3156"," 2859"," 2594"," 2604"," 2774"," 2860"," 3146"],["5.0e-08","7.3e-06","3.7e-02","2.6e-27","6.5e-07","6.8e-06","2.0e-15","3.0e-15","2.9e-13","2.0e-12","1.2e-11","1.7e-11","2.0e-11","4.1e-11","4.2e-11","8.1e-11","4.9e-17"],["5.0e-08","7.3e-06","3.7e-02","2.6e-27","6.5e-07","6.8e-06","2.0e-15","3.0e-15","2.9e-13","2.0e-12","1.2e-11","1.7e-11","2.0e-11","4.1e-11","4.2e-11","8.1e-11","4.9e-17"],["0.46","1.48","1.51","1.28","0.45","1.43","0.92","1.13","0.57","0.79","0.27","0.41","0.78","1.13","0.56","0.54","0.65"],["1.59","2.28","1.87","2.54","0.86","1.83","2.55","2.59","1.46","1.71","1.59","1.32","1.80","2.16","1.44","1.51","1.74"],["0.41","0.85","0.85","0.83","0.38","0.85","0.77","0.85","0.58","0.75","0.33","0.46","0.72","0.87","0.57","0.56","0.54"],["0.73","0.97","1.00","0.99","0.63","0.97","1.00","1.00","0.95","0.97","0.70","0.84","0.95","0.97","0.86","0.89","0.94"],["0.32","0.11","0.15","0.16","0.25","0.12","0.23","0.15","0.37","0.22","0.38","0.38","0.22","0.10","0.30","0.33","0.40"],["0.32","0.11","0.15","0.16","0.25","0.12","0.23","0.15","0.37","0.22","0.38","0.38","0.22","0.10","0.30","0.33","0.40"],["CD26 (Adenosine)","CD28","CD28","CD28","CD26 (Adenosine)","CD3","LAMP1","CD45RO","CD45","B220 (CD45R)","CD14","B7-H1 (PD-L1)","Siglec-8","PD-L1 (CD274)","TCRg","EpCAM (CD326)","CD366 (tim3)"],["1","1","4","5","5","5","6","6","6","6","6","6","6","6","6","6","9"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>stats.W<\/th>\n      <th>pval<\/th>\n      <th>p.adjust<\/th>\n      <th>meanExprs.1<\/th>\n      <th>meanExprs.2<\/th>\n      <th>meanPct.1<\/th>\n      <th>meanPct.2<\/th>\n      <th>meanDiff<\/th>\n      <th>pctDiff<\/th>\n      <th>name<\/th>\n      <th>group<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="visualising-de-results" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-de-results" class="anchor"></a>Visualising DE results</h2>
<div id="circlepackplot" class="section level3">
<h3 class="hasAnchor">
<a href="#circlepackplot" class="anchor"></a>circlepackPlot</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">rna_DEgenes &lt;-<span class="st"> </span><span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"DE_res_RNA_filter"</span>]]</a>
<a class="sourceLine" id="cb60-2" data-line-number="2">adt_DEgenes &lt;-<span class="st"> </span><span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"DE_res_ADT_filter"</span>]]</a>
<a class="sourceLine" id="cb60-3" data-line-number="3"></a>
<a class="sourceLine" id="cb60-4" data-line-number="4">rna_DEgenes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(rna_DEgenes, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb60-5" data-line-number="5">  x<span class="op">$</span>name &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"hg19_"</span>, <span class="st">""</span>, x<span class="op">$</span>name)</a>
<a class="sourceLine" id="cb60-6" data-line-number="6">  x})</a>
<a class="sourceLine" id="cb60-7" data-line-number="7"><span class="kw"><a href="../reference/DEbubblePlot.html">DEbubblePlot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">RNA =</span> rna_DEgenes, <span class="dt">ADT =</span> adt_DEgenes))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-25-1.png" width="960"></p>
</div>
<div id="decomparisonplot" class="section level3">
<h3 class="hasAnchor">
<a href="#decomparisonplot" class="anchor"></a>DEcomparisonPlot</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">rna_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD4"</span>,</a>
<a class="sourceLine" id="cb61-2" data-line-number="2">              <span class="st">"hg19_CD8A"</span>,</a>
<a class="sourceLine" id="cb61-3" data-line-number="3">              <span class="st">"hg19_HLA-DRB1"</span>,</a>
<a class="sourceLine" id="cb61-4" data-line-number="4">              <span class="st">"hg19_ITGAX"</span>,</a>
<a class="sourceLine" id="cb61-5" data-line-number="5">              <span class="st">"hg19_NCAM1"</span>,</a>
<a class="sourceLine" id="cb61-6" data-line-number="6">              <span class="st">"hg19_CD27"</span>,</a>
<a class="sourceLine" id="cb61-7" data-line-number="7">              <span class="st">"hg19_CD19"</span>)</a>
<a class="sourceLine" id="cb61-8" data-line-number="8"></a>
<a class="sourceLine" id="cb61-9" data-line-number="9">adt_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD4"</span>, <span class="st">"CD8"</span>, <span class="st">"MHCII (HLA-DR)"</span>, <span class="st">"CD11c"</span>, <span class="st">"CD56"</span>, <span class="st">"CD27"</span>, <span class="st">"CD19"</span>)</a>
<a class="sourceLine" id="cb61-10" data-line-number="10"></a>
<a class="sourceLine" id="cb61-11" data-line-number="11">rna_DEgenes_all &lt;-<span class="st"> </span><span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"DE_res_RNA"</span>]]</a>
<a class="sourceLine" id="cb61-12" data-line-number="12">adt_DEgenes_all &lt;-<span class="st"> </span><span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"DE_res_ADT"</span>]]</a>
<a class="sourceLine" id="cb61-13" data-line-number="13"></a>
<a class="sourceLine" id="cb61-14" data-line-number="14">feature_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">RNA =</span> rna_list, <span class="dt">ADT =</span> adt_list)</a>
<a class="sourceLine" id="cb61-15" data-line-number="15">de_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">RNA =</span> rna_DEgenes_all, <span class="dt">ADT =</span> adt_DEgenes_all)</a>
<a class="sourceLine" id="cb61-16" data-line-number="16"></a>
<a class="sourceLine" id="cb61-17" data-line-number="17"><span class="kw"><a href="../reference/DEcomparisonPlot.html">DEcomparisonPlot</a></span>(<span class="dt">de_list =</span> de_list,</a>
<a class="sourceLine" id="cb61-18" data-line-number="18">                 <span class="dt">feature_list =</span> feature_list)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-26-1.png" width="960"></p>
</div>
</div>
</div>
<div id="adt-importance-evaluation" class="section level1">
<h1 class="hasAnchor">
<a href="#adt-importance-evaluation" class="anchor"></a>ADT importance evaluation</h1>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">2020</span>)</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/importanceADT.html">importanceADT</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb62-3" data-line-number="3">                             <span class="dt">group =</span> sce_citeseq<span class="op">$</span>SNF_W_louvain,</a>
<a class="sourceLine" id="cb62-4" data-line-number="4">                             <span class="dt">subsample =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb62-5" data-line-number="5"></a>
<a class="sourceLine" id="cb62-6" data-line-number="6"><span class="kw"><a href="../reference/visImportance.html">visImportance</a></span>(sce_citeseq, <span class="dt">plot =</span> <span class="st">"boxplot"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-27-1.png" width="768"></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw"><a href="../reference/visImportance.html">visImportance</a></span>(sce_citeseq, <span class="dt">plot =</span> <span class="st">"heatmap"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-27-2.png" width="768"></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"importanceADT"</span>]], <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]</a></code></pre></div>
<pre><code>##               CD4               CD8              CD27               CD5 
##         30.558333         29.224077         27.691326         22.097058 
##               CD7      PECAM (CD31)             CD11b               CD2 
##         16.041289         13.495346         12.716874         12.241439 
##    MHCII (HLA-DR)              CD28              CD44 IL7Ralpha (CD127) 
##         10.332952         10.189411          9.006814          8.808518 
##         HLA-A,B,C             CD62L             CD11c            CD45RA 
##          6.961884          5.921209          5.678501          5.612525 
##      CD366 (tim3)               CD3              CD56      PD-1 (CD279) 
##          5.294986          5.263878          4.732472          4.427862</code></pre>
<p>Select the ADT with scores greater than 5 and perform SNF again</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">subset_adt &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"importanceADT"</span>]] <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb66-2" data-line-number="2">subset_adt</a></code></pre></div>
<pre><code>##  [1] "CD11b"             "CD11c"             "CD2"              
##  [4] "CD27"              "CD28"              "CD3"              
##  [7] "CD366 (tim3)"      "CD4"               "CD44"             
## [10] "CD45RA"            "CD5"               "CD62L"            
## [13] "CD7"               "CD8"               "HLA-A,B,C"        
## [16] "IL7Ralpha (CD127)" "MHCII (HLA-DR)"    "PECAM (CD31)"</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CiteFuse.html">CiteFuse</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb68-2" data-line-number="2">                                    <span class="dt">ADT_subset =</span> subset_adt,</a>
<a class="sourceLine" id="cb68-3" data-line-number="3">                                    <span class="dt">metadata_names =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"W_SNF_adtSubset1"</span>,</a>
<a class="sourceLine" id="cb68-4" data-line-number="4">                                                       <span class="st">"W_ADT_adtSubset1"</span>,</a>
<a class="sourceLine" id="cb68-5" data-line-number="5">                                                       <span class="st">"W_RNA"</span>)))</a></code></pre></div>
<pre><code>## Calculating affinity matrix 
## Performing SNF</code></pre>
<pre><code>##    user  system elapsed 
##   1.968   0.040   2.010</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1">SNF_W_clust_adtSubset1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"W_SNF_adtSubset1"</span>]], <span class="dt">K =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">sce_citeseq<span class="op">$</span>SNF_W_clust_adtSubset1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(SNF_W_clust_adtSubset1<span class="op">$</span>labels)</a>
<a class="sourceLine" id="cb73-2" data-line-number="2"></a>
<a class="sourceLine" id="cb73-3" data-line-number="3"></a>
<a class="sourceLine" id="cb73-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mclust)</a>
<a class="sourceLine" id="cb73-5" data-line-number="5"><span class="kw"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span>(sce_citeseq<span class="op">$</span>SNF_W_clust_adtSubset1, sce_citeseq<span class="op">$</span>SNF_W_clust)</a></code></pre></div>
<pre><code>## [1] 0.9305236</code></pre>
</div>
<div id="gene---adt-network" class="section level1">
<h1 class="hasAnchor">
<a href="#gene---adt-network" class="anchor"></a>Gene - ADT network</h1>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">RNA_feature_subset &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(rna_DEgenes_all, <span class="st">"[["</span>, <span class="st">"name"</span>))))</a>
<a class="sourceLine" id="cb75-2" data-line-number="2">ADT_feature_subset &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(adt_DEgenes_all, <span class="st">"[["</span>, <span class="st">"name"</span>))))</a>
<a class="sourceLine" id="cb75-3" data-line-number="3"></a>
<a class="sourceLine" id="cb75-4" data-line-number="4"><span class="kw"><a href="../reference/geneADTnetwork.html">geneADTnetwork</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb75-5" data-line-number="5">               <span class="dt">RNA_feature_subset =</span> RNA_feature_subset,</a>
<a class="sourceLine" id="cb75-6" data-line-number="6">               <span class="dt">ADT_feature_subset =</span> ADT_feature_subset,</a>
<a class="sourceLine" id="cb75-7" data-line-number="7">               <span class="dt">cor_method =</span> <span class="st">"pearson"</span>,</a>
<a class="sourceLine" id="cb75-8" data-line-number="8">               <span class="dt">network_layout =</span> igraph<span class="op">::</span>layout_with_fr)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-29-1.png" width="768"></p>
<pre><code>## IGRAPH 0f20910 UN-B 72 134 -- 
## + attr: name (v/c), label (v/c), class (v/c), type (v/l), shape (v/c),
## | color (v/c), size (v/n), label.cex (v/n), label.color (v/c), value
## | (e/n), color (e/c), weights (e/n)
## + edges from 0f20910 (vertex names):
##  [1] RNA_hg19_IL7R  --ADT_CD28             
##  [2] RNA_hg19_LTB   --ADT_CD28             
##  [3] RNA_hg19_NKG7  --ADT_CD28             
##  [4] RNA_hg19_CST7  --ADT_CD28             
##  [5] RNA_hg19_GNLY  --ADT_CD28             
##  [6] RNA_hg19_CCL5  --ADT_CD28             
## + ... omitted several edges</code></pre>
</div>
<div id="rna-ligand---adt-receptor-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#rna-ligand---adt-receptor-analysis" class="anchor"></a>RNA Ligand - ADT Receptor Analysis</h1>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"lr_pair_subset"</span>, <span class="dt">package =</span> <span class="st">"CiteFuse"</span>)</a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(lr_pair_subset)</a></code></pre></div>
<pre><code>##      [,1]          [,2]   
## [1,] "hg19_IL17RA" "CD45" 
## [2,] "hg19_FAS"    "CD11b"
## [3,] "hg19_GZMK"   "CD62L"
## [4,] "hg19_CD40LG" "CD11b"
## [5,] "hg19_FLT3LG" "CD62L"
## [6,] "hg19_GZMA"   "CD19"</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(<span class="dt">sce =</span> sce_citeseq, </a>
<a class="sourceLine" id="cb79-2" data-line-number="2">                              <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb79-3" data-line-number="3">                              <span class="dt">transform =</span> <span class="st">"zi_minMax"</span>)</a>
<a class="sourceLine" id="cb79-4" data-line-number="4"></a>
<a class="sourceLine" id="cb79-5" data-line-number="5">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(<span class="dt">sce =</span> sce_citeseq, </a>
<a class="sourceLine" id="cb79-6" data-line-number="6">                              <span class="dt">altExp_name =</span> <span class="st">"none"</span>, </a>
<a class="sourceLine" id="cb79-7" data-line-number="7">                              <span class="dt">exprs_value =</span> <span class="st">"logcounts"</span>,</a>
<a class="sourceLine" id="cb79-8" data-line-number="8">                              <span class="dt">transform =</span> <span class="st">"minMax"</span>)</a>
<a class="sourceLine" id="cb79-9" data-line-number="9"></a>
<a class="sourceLine" id="cb79-10" data-line-number="10">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ligandReceptorTest.html">ligandReceptorTest</a></span>(<span class="dt">sce =</span> sce_citeseq,</a>
<a class="sourceLine" id="cb79-11" data-line-number="11">                                  <span class="dt">ligandReceptor_list =</span> lr_pair_subset,</a>
<a class="sourceLine" id="cb79-12" data-line-number="12">                                  <span class="dt">cluster =</span> sce_citeseq<span class="op">$</span>SNF_W_louvain,</a>
<a class="sourceLine" id="cb79-13" data-line-number="13">                                  <span class="dt">RNA_exprs_value =</span> <span class="st">"minMax"</span>,</a>
<a class="sourceLine" id="cb79-14" data-line-number="14">                                  <span class="dt">use_alt_exp =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb79-15" data-line-number="15">                                  <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>,</a>
<a class="sourceLine" id="cb79-16" data-line-number="16">                                  <span class="dt">altExp_exprs_value =</span> <span class="st">"zi_minMax"</span>,</a>
<a class="sourceLine" id="cb79-17" data-line-number="17">                                  <span class="dt">num_permute =</span> <span class="dv">1000</span>) </a></code></pre></div>
<pre><code>## 100 ......200 ......300 ......400 ......500 ......600 ......700 ......800 ......900 ......1000 ......</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb81-2" data-line-number="2">                  <span class="dt">type =</span> <span class="st">"pval_heatmap"</span>,</a>
<a class="sourceLine" id="cb81-3" data-line-number="3">                  <span class="dt">receptor_type =</span> <span class="st">"ADT"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-31-1.png" width="768"></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb82-2" data-line-number="2">                  <span class="dt">type =</span> <span class="st">"pval_dotplot"</span>,</a>
<a class="sourceLine" id="cb82-3" data-line-number="3">                  <span class="dt">receptor_type =</span> <span class="st">"ADT"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-32-1.png" width="576"></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb83-2" data-line-number="2">                  <span class="dt">type =</span> <span class="st">"group_network"</span>,</a>
<a class="sourceLine" id="cb83-3" data-line-number="3">                  <span class="dt">receptor_type =</span> <span class="st">"ADT"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-33-1.png" width="768"></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb84-2" data-line-number="2">                  <span class="dt">type =</span> <span class="st">"group_heatmap"</span>,</a>
<a class="sourceLine" id="cb84-3" data-line-number="3">                  <span class="dt">receptor_type =</span> <span class="st">"ADT"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-34-1.png" width="768"></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="kw"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb85-2" data-line-number="2">                  <span class="dt">type =</span> <span class="st">"lr_network"</span>,</a>
<a class="sourceLine" id="cb85-3" data-line-number="3">                  <span class="dt">receptor_type =</span> <span class="st">"ADT"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-35-1.png" width="768"></p>
</div>
<div id="analysis-cross-condtions" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis-cross-condtions" class="anchor"></a>Analysis cross condtions</h1>
<p>Here we will jointly analysis the current data in control condtion, with the another subset in CTCL condition from Mimitou et al.. The data <code>sce_ctcl_subset</code> provided in <code>CiteFuse</code> package already contain the clustering inforamtion.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"sce_ctcl_subset"</span>, <span class="dt">package =</span> <span class="st">"CiteFuse"</span>)</a></code></pre></div>
<p>To visualise jointly gene or protein expression data, we can use <code>visualiseExprsList</code> function.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprsList.html">visualiseExprsList</a></span>(<span class="dt">sce_list =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">control =</span> sce_citeseq,</a>
<a class="sourceLine" id="cb87-2" data-line-number="2">                                   <span class="dt">ctcl =</span> sce_ctcl_subset),</a>
<a class="sourceLine" id="cb87-3" data-line-number="3">                   <span class="dt">plot =</span> <span class="st">"boxplot"</span>,</a>
<a class="sourceLine" id="cb87-4" data-line-number="4">                   <span class="dt">altExp_name =</span> <span class="st">"none"</span>,</a>
<a class="sourceLine" id="cb87-5" data-line-number="5">                   <span class="dt">exprs_value =</span> <span class="st">"logcounts"</span>,</a>
<a class="sourceLine" id="cb87-6" data-line-number="6">                   <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_S100A10"</span>, <span class="st">"hg19_CD8A"</span>),</a>
<a class="sourceLine" id="cb87-7" data-line-number="7">                   <span class="dt">group_by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SNF_W_louvain"</span>, <span class="st">"SNF_W_louvain"</span>))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprsList.html">visualiseExprsList</a></span>(<span class="dt">sce_list =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">control =</span> sce_citeseq,</a>
<a class="sourceLine" id="cb88-2" data-line-number="2">                                   <span class="dt">ctcl =</span> sce_ctcl_subset),</a>
<a class="sourceLine" id="cb88-3" data-line-number="3">                   <span class="dt">plot =</span> <span class="st">"boxplot"</span>,</a>
<a class="sourceLine" id="cb88-4" data-line-number="4">                   <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb88-5" data-line-number="5">                   <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD19"</span>, <span class="st">"CD8"</span>),</a>
<a class="sourceLine" id="cb88-6" data-line-number="6">                   <span class="dt">group_by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SNF_W_louvain"</span>, <span class="st">"SNF_W_louvain"</span>))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-37-2.png" width="700"></p>
<p>We can then perform differential expression analysis in RNA epxression level across the two clusters that have high CD19 expression in ADT.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">de_res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/DEgenesCross.html">DEgenesCross</a></span>(<span class="dt">sce_list =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">control =</span> sce_citeseq,</a>
<a class="sourceLine" id="cb89-2" data-line-number="2">                                       <span class="dt">ctcl =</span> sce_ctcl_subset),</a>
<a class="sourceLine" id="cb89-3" data-line-number="3">                       <span class="dt">colData_name =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SNF_W_louvain"</span>, <span class="st">"SNF_W_louvain"</span>),</a>
<a class="sourceLine" id="cb89-4" data-line-number="4">                       <span class="dt">group_to_test =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"2"</span>, <span class="st">"6"</span>))</a>
<a class="sourceLine" id="cb89-5" data-line-number="5">de_res_filter &lt;-<span class="st"> </span><span class="kw"><a href="../reference/selectDEgenes.html">selectDEgenes</a></span>(<span class="dt">de_res =</span> de_res)</a>
<a class="sourceLine" id="cb89-6" data-line-number="6">de_res_filter</a></code></pre></div>
<pre><code>## $control
##            stats.W         pval     p.adjust meanExprs.1 meanExprs.2  meanPct.1
## hg19_NKG7     82.0 9.717299e-13 9.717299e-13  0.51066894   3.2333024 0.30232558
## hg19_CST7    138.0 5.875063e-12 5.875063e-12  0.22512314   2.2146495 0.13953488
## hg19_GNLY    186.0 8.935760e-12 8.935760e-12  0.07220401   2.7782587 0.02325581
## hg19_CCL5    124.0 2.418174e-11 2.418174e-11  1.04348029   3.7809281 0.37209302
## hg19_GZMH    258.0 1.807873e-10 1.807873e-10  0.00000000   1.4711399 0.00000000
## hg19_ITGB2   210.0 4.203966e-09 4.203966e-09  0.44185664   1.7346818 0.44186047
## hg19_KLRD1   322.5 5.000482e-08 5.000482e-08  0.09327555   1.0358615 0.09302326
## hg19_GZMA    284.5 5.732252e-08 5.732252e-08  0.32515702   1.5433119 0.18604651
## hg19_ZEB2    387.0 7.878997e-08 7.878997e-08  0.00000000   0.8211807 0.00000000
## hg19_CD99    274.0 1.679625e-07 1.679625e-07  0.58551572   1.5699157 0.46511628
##            meanPct.2  meanDiff   pctDiff       name   group
## hg19_NKG7  1.0000000 0.6976744 0.6976744  hg19_NKG7 control
## hg19_CST7  0.8947368 0.7552020 0.7552020  hg19_CST7 control
## hg19_GNLY  0.7894737 0.7662179 0.7662179  hg19_GNLY control
## hg19_CCL5  1.0000000 0.6279070 0.6279070  hg19_CCL5 control
## hg19_GZMH  0.6842105 0.6842105 0.6842105  hg19_GZMH control
## hg19_ITGB2 0.8684211 0.4265606 0.4265606 hg19_ITGB2 control
## hg19_KLRD1 0.6578947 0.5648715 0.5648715 hg19_KLRD1 control
## hg19_GZMA  0.8157895 0.6297430 0.6297430  hg19_GZMA control
## hg19_ZEB2  0.5263158 0.5263158 0.5263158  hg19_ZEB2 control
## hg19_CD99  0.8947368 0.4296206 0.4296206  hg19_CD99 control
## 
## $ctcl
##                stats.W         pval     p.adjust meanExprs.1 meanExprs.2
## hg19_RPS26         0.0 1.087530e-14 1.087530e-14  1.42819970    5.072471
## hg19_LTB         235.0 1.478865e-08 1.478865e-08  0.48566164    1.978730
## hg19_SELL        298.5 3.618421e-08 3.618421e-08  0.10674144    1.152572
## hg19_LEPROTL1    268.0 9.163954e-08 9.163954e-08  0.37427389    1.300745
## hg19_NOSIP       306.0 2.589055e-07 2.589055e-07  0.23412389    1.157235
## hg19_LINC02446   352.0 3.887845e-07 3.887845e-07  0.09889831    1.004083
## hg19_FOS         353.5 5.438707e-07 5.438707e-07  0.14088922    1.125337
## hg19_TMEM123     331.0 1.090629e-06 1.090629e-06  0.26112624    1.012034
## hg19_LDHB        325.0 2.344648e-06 2.344648e-06  0.70148411    1.588459
## hg19_NPM1        323.0 2.836125e-06 2.836125e-06  1.24903807    2.202268
##                 meanPct.1 meanPct.2  meanDiff   pctDiff           name group
## hg19_RPS26     0.84210526 1.0000000 0.1578947 0.1578947     hg19_RPS26  ctcl
## hg19_LTB       0.28947368 0.9069767 0.6175031 0.6175031       hg19_LTB  ctcl
## hg19_SELL      0.07894737 0.6976744 0.6187271 0.6187271      hg19_SELL  ctcl
## hg19_LEPROTL1  0.28947368 0.9069767 0.6175031 0.6175031  hg19_LEPROTL1  ctcl
## hg19_NOSIP     0.21052632 0.7674419 0.5569155 0.5569155     hg19_NOSIP  ctcl
## hg19_LINC02446 0.07894737 0.6279070 0.5489596 0.5489596 hg19_LINC02446  ctcl
## hg19_FOS       0.07894737 0.6511628 0.5722154 0.5722154       hg19_FOS  ctcl
## hg19_TMEM123   0.23684211 0.7674419 0.5305998 0.5305998   hg19_TMEM123  ctcl
## hg19_LDHB      0.50000000 0.8604651 0.3604651 0.3604651      hg19_LDHB  ctcl
## hg19_NPM1      0.68421053 0.9534884 0.2692778 0.2692778      hg19_NPM1  ctcl</code></pre>
</div>
<div id="sessioninfo" class="section level1">
<h1 class="hasAnchor">
<a href="#sessioninfo" class="anchor"></a>SessionInfo</h1>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</a></code></pre></div>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.3
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] mclust_5.4.5                gridExtra_2.3              
##  [3] DT_0.10                     scater_1.14.4              
##  [5] ggplot2_3.2.1               SingleCellExperiment_1.8.0 
##  [7] SummarizedExperiment_1.16.0 DelayedArray_0.12.0        
##  [9] BiocParallel_1.20.0         matrixStats_0.55.0         
## [11] Biobase_2.46.0              GenomicRanges_1.38.0       
## [13] GenomeInfoDb_1.22.0         IRanges_2.20.1             
## [15] S4Vectors_0.24.3            BiocGenerics_0.32.0        
## [17] CiteFuse_0.1.0             
## 
## loaded via a namespace (and not attached):
##   [1] Rtsne_0.15               ggbeeswarm_0.6.0         colorspace_1.4-1        
##   [4] RcppEigen_0.3.3.7.0      ggridges_0.5.1           rprojroot_1.3-2         
##   [7] XVector_0.26.0           BiocNeighbors_1.4.1      fs_1.3.1                
##  [10] rstudioapi_0.10          farver_2.0.1             graphlayouts_0.5.0      
##  [13] ggrepel_0.8.1            RSpectra_0.16-0          splines_3.6.1           
##  [16] knitr_1.26               heatmap.plus_1.3         polyclip_1.10-0         
##  [19] zeallot_0.1.0            jsonlite_1.6             alluvial_0.1-2          
##  [22] pheatmap_1.0.12          uwot_0.1.4               shiny_1.4.0             
##  [25] ggforce_0.3.1            ExPosition_2.8.23        compiler_3.6.1          
##  [28] dqrng_0.2.1              prettyGraphs_2.1.6       backports_1.1.5         
##  [31] fastmap_1.0.1            assertthat_0.2.1         Matrix_1.2-18           
##  [34] lazyeval_0.2.2           limma_3.42.0             later_1.0.0             
##  [37] tweenr_1.0.1             BiocSingular_1.2.0       htmltools_0.4.0         
##  [40] tools_3.6.1              rsvd_1.0.2               igraph_1.2.4.2          
##  [43] gtable_0.3.0             glue_1.3.1               GenomeInfoDbData_1.2.2  
##  [46] reshape2_1.4.3           dplyr_0.8.3              Rcpp_1.0.3              
##  [49] pkgdown_1.4.1            vctrs_0.2.0              crosstalk_1.0.0         
##  [52] DelayedMatrixStats_1.8.0 ggraph_2.0.0             xfun_0.11               
##  [55] stringr_1.4.0            mime_0.7                 lifecycle_0.1.0         
##  [58] irlba_2.3.3              statmod_1.4.32           edgeR_3.28.0            
##  [61] zlibbioc_1.32.0          MASS_7.3-51.4            scales_1.1.0            
##  [64] tidygraph_1.1.2          promises_1.1.0           rhdf5_2.30.1            
##  [67] RColorBrewer_1.1-2       SNFtool_2.3.0            yaml_2.2.0              
##  [70] memoise_1.1.0            segmented_1.0-0          stringi_1.4.3           
##  [73] desc_1.2.0               randomForest_4.6-14      scran_1.14.6            
##  [76] rlang_0.4.2              pkgconfig_2.0.3          bitops_1.0-6            
##  [79] evaluate_0.14            lattice_0.20-38          purrr_0.3.3             
##  [82] Rhdf5lib_1.8.0           labeling_0.3             htmlwidgets_1.5.1       
##  [85] cowplot_1.0.0            tidyselect_0.2.5         plyr_1.8.4              
##  [88] magrittr_1.5             R6_2.4.1                 withr_2.1.2             
##  [91] pillar_1.4.2             mixtools_1.1.0           survival_3.1-8          
##  [94] RCurl_1.95-4.12          tibble_2.1.3             crayon_1.3.4            
##  [97] rmarkdown_1.18           viridis_0.5.1            locfit_1.5-9.1          
## [100] grid_3.6.1               FNN_1.1.3                propr_4.1.6             
## [103] digest_0.6.23            xtable_1.8-4             httpuv_1.5.2            
## [106] tidyr_1.0.0              dbscan_1.1-5             RcppParallel_4.4.4      
## [109] munsell_0.5.0            beeswarm_0.2.3           viridisLite_0.3.0       
## [112] vipor_0.4.5</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#detecting-both-cross--and-within-sample-doublets-using-citefuse">Detecting both cross- and within-sample doublets using <code>CiteFuse</code></a><ul class="nav nav-pills nav-stacked">
<li><a href="#hto-normalisation-and-visualisation">HTO Normalisation and Visualisation</a></li>
      <li><a href="#doublet-identification-cross-sample">Doublet Identification (cross sample)</a></li>
      <li><a href="#doublet-identification-within-samples">Doublet Identification (within samples)</a></li>
      </ul>
</li>
      <li>
<a href="#clustering">Clustering</a><ul class="nav nav-pills nav-stacked">
<li><a href="#performing-snf">Performing SNF</a></li>
      <li><a href="#performing-spectral-clustering">Performing spectral clustering</a></li>
      <li><a href="#visualisation">Visualisation</a></li>
      <li><a href="#louvain-clustering">Louvain Clustering</a></li>
      </ul>
</li>
      <li>
<a href="#differential-expression-analysis">Differential Expression Analysis</a><ul class="nav nav-pills nav-stacked">
<li><a href="#exploration-of-features-expression">Exploration of features expression</a></li>
      <li><a href="#perform-de-analysis-using-wilcoxon-rank-sum-test">Perform DE analysis using Wilcoxon Rank Sum test</a></li>
      <li><a href="#visualising-de-results">Visualising DE results</a></li>
      </ul>
</li>
      <li><a href="#adt-importance-evaluation">ADT importance evaluation</a></li>
      <li><a href="#gene---adt-network">Gene - ADT network</a></li>
      <li><a href="#rna-ligand---adt-receptor-analysis">RNA Ligand - ADT Receptor Analysis</a></li>
      <li><a href="#analysis-cross-condtions">Analysis cross condtions</a></li>
      <li><a href="#sessioninfo">SessionInfo</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Yingxin Lin, Hani Kim.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
