<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CiteFuse: getting start â€¢ CiteFuse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="CiteFuse: getting start">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CiteFuse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Getting start
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CiteFuse.html">Getting start with CiteFuse</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SydneyBioX/CiteFuse">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="CiteFuse_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="CiteFuse_files/jquery-1.12.4/jquery.min.js"></script><link href="CiteFuse_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="CiteFuse_files/datatables-binding-0.10/datatables.js"></script><link href="CiteFuse_files/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="CiteFuse_files/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="CiteFuse_files/dt-core-1.10.19/js/jquery.dataTables.min.js"></script><link href="CiteFuse_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
<script src="CiteFuse_files/crosstalk-1.0.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>CiteFuse: getting start</h1>
            
      
      
      <div class="hidden name"><code>CiteFuse.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>CiteFuse</code> is a computational framework that implements a suite of methods and tools for CITE-seq data from pre-processing through to integrative analytics. This includes doublet detection, network-based modality integration, cell type clustering, differential RNA and ADT expression analysis, ADT evaluation, ligand-receptor interaction analysis, and interactive web-based visualisation of the analyses. this vignette demostrates the usage of <code>CiteFuse</code> using a small subset data of CITE-seq data from PBMC as an example (Mimitou et al., 2019).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(CiteFuse)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(scater)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(SingleCellExperiment)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DT)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"CITEseq_example"</span>, <span class="dt">package =</span> <span class="st">"CiteFuse"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(CITEseq_example)</a></code></pre></div>
<pre><code>## [1] "RNA" "ADT" "HTO"</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(CITEseq_example, dim)</a></code></pre></div>
<pre><code>## $RNA
## [1] 19521   500
## 
## $ADT
## [1]  49 500
## 
## $HTO
## [1]   4 500</code></pre>
<p>Here, we started from a list of three matrices of RNA, ADT and HTO, which have common cell names. The <code>preprocessing</code> function will utilise the three matrices and its common cell names to create a <code>SingleCellExperiment</code> object, which stores RNA data in <code>assay</code>, and <code>ADT</code>, <code>HTO</code> data in <code>altExp</code> slot.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/preprocessing.html">preprocessing</a></span>(CITEseq_example)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">sce_citeseq</a></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 14919 500 
## metadata(0):
## assays(1): counts
## rownames(14919): hg19_AL627309.1 hg19_AL669831.5 ... hg19_MT-ND6
##   hg19_MT-CYB
## rowData names(0):
## colnames(500): AAGCCGCGTTGTCTTT GATCGCGGTTATCGGT ... TTGGCAACACTAGTAC
##   GCTGCGAGTTGTGGCC
## colData names(0):
## reducedDimNames(0):
## spikeNames(0):
## altExpNames(2): ADT HTO</code></pre>
</div>
<div id="detecting-both-cross--and-within-sample-doublets-using-citefuse" class="section level1">
<h1 class="hasAnchor">
<a href="#detecting-both-cross--and-within-sample-doublets-using-citefuse" class="anchor"></a>Detecting both cross- and within-sample doublets using <code>CiteFuse</code>
</h1>
<div id="hto-normalisation-and-visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#hto-normalisation-and-visualisation" class="anchor"></a>HTO Normalisation and Visualisation</h2>
<p>The function <code>notmaliseExprs</code> is used to scale the alternative expression. Here, we used it to perform log-transformation for the <code>HTO</code> expression, by setting <code>transform = "log"</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(<span class="dt">sce =</span> sce_citeseq, </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                              <span class="dt">altExp_name =</span> <span class="st">"HTO"</span>, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">                              <span class="dt">transform =</span> <span class="st">"log"</span>)</a></code></pre></div>
<p>Then we can perform dimension reduction on the <code>HTO</code> expression using <code>runTSNE</code> or <code>runUMAP</code>, then use <code>visualiseDim</code> function to visualise the reduced dimension plot.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span>scater<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/scater/man/runTSNE.html">runTSNE</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                               <span class="dt">altexp =</span> <span class="st">"HTO"</span>, </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                               <span class="dt">name =</span> <span class="st">"TSNE_HTO"</span>, </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                               <span class="dt">pca =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">             <span class="dt">dimNames =</span> <span class="st">"TSNE_HTO"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"tSNE (HTO)"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span>scater<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/scater/man/runUMAP.html">runUMAP</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb10-2" data-line-number="2">                               <span class="dt">altexp =</span> <span class="st">"HTO"</span>, </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                               <span class="dt">name =</span> <span class="st">"UMAP_HTO"</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">             <span class="dt">dimNames =</span> <span class="st">"UMAP_HTO"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"UMAP (HTO)"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-5-2.png" width="576"></p>
</div>
<div id="doublet-identification-cross-sample" class="section level2">
<h2 class="hasAnchor">
<a href="#doublet-identification-cross-sample" class="anchor"></a>Doublet Identification (cross sample)</h2>
<p>We first identify the cross-sample doublets via function <code>crossSampleDoublets</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/crossSampleDoublets.html">crossSampleDoublets</a></span>(sce_citeseq)</a></code></pre></div>
<pre><code>## number of iterations= 14 
## number of iterations= 17 
## number of iterations= 15 
## number of iterations= 325</code></pre>
<p>The results of the cross sample doublets are then saved in the <code>colData</code> as <code>doubletClassify_between_label</code> and <code>doubletClassify_between_class</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(sce_citeseq<span class="op">$</span>doubletClassify_between_label)</a></code></pre></div>
<pre><code>## 
##                 1                 2                 3                 4 
##               115               121                92               129 
## doublet/multiplet 
##                43</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(sce_citeseq<span class="op">$</span>doubletClassify_between_class)</a></code></pre></div>
<pre><code>## 
## doublet/multiplet           Singlet 
##                43               457</code></pre>
<p>We can then highlights the cross-sample doublets in our tSNE plot of HTO expression.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb17-2" data-line-number="2">             <span class="dt">dimNames =</span> <span class="st">"TSNE_HTO"</span>, </a>
<a class="sourceLine" id="cb17-3" data-line-number="3">             <span class="dt">colour_by =</span> <span class="st">"doubletClassify_between_label"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>Further, <code>plotHTO</code> function allows us to plot the pairwise scatter HTO expression.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="../reference/plotHTO.html">plotHTO</a></span>(sce_citeseq, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
</div>
<div id="doublet-identification-within-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#doublet-identification-within-samples" class="anchor"></a>Doublet Identification (within samples)</h2>
<p>We then identify the within-sample doublets via function <code>withinSampleDoublets</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/withinSampleDoublets.html">withinSampleDoublets</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">                                    <span class="dt">minPts =</span> <span class="dv">10</span>)</a></code></pre></div>
<p>The results of the cross sample doublets are then saved in the <code>colData</code> as <code>doubletClassify_within_label</code> and <code>doubletClassify_within_class</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(sce_citeseq<span class="op">$</span>doubletClassify_within_label)</a></code></pre></div>
<pre><code>## 
##  Doublets(Within)_1  Doublets(Within)_2  Doublets(Within)_3  Doublets(Within)_4 
##                   3                   7                   4                   6 
## NotDoublets(Within) 
##                 480</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(sce_citeseq<span class="op">$</span>doubletClassify_within_class)</a></code></pre></div>
<pre><code>## 
## Doublet Singlet 
##      20     480</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb24-2" data-line-number="2">             <span class="dt">dimNames =</span> <span class="st">"TSNE_HTO"</span>, </a>
<a class="sourceLine" id="cb24-3" data-line-number="3">             <span class="dt">colour_by =</span> <span class="st">"doubletClassify_within_label"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
<p>Finally, we can filter out the doublets cells (Both within and between batches) for the downstream analysis.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span>sce_citeseq[, sce_citeseq<span class="op">$</span>doubletClassify_within_class <span class="op">==</span><span class="st"> "Singlet"</span> <span class="op">&amp;</span><span class="st"> </span>sce_citeseq<span class="op">$</span>doubletClassify_between_class <span class="op">==</span><span class="st"> "Singlet"</span>]</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">sce_citeseq</a></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 14919 437 
## metadata(3): doubletClassify_between_threshold
##   doubletClassify_between_resultsMat doubletClassify_within_resultsMat
## assays(1): counts
## rownames(14919): hg19_AL627309.1 hg19_AL669831.5 ... hg19_MT-ND6
##   hg19_MT-CYB
## rowData names(0):
## colnames(437): GATCGCGGTTATCGGT GGCTGGTAGAGGTTAT ... TTGGCAACACTAGTAC
##   GCTGCGAGTTGTGGCC
## colData names(5): doubletClassify_between_label
##   doubletClassify_between_class nUMI doubletClassify_within_label
##   doubletClassify_within_class
## reducedDimNames(2): TSNE_HTO UMAP_HTO
## spikeNames(0):
## altExpNames(2): ADT HTO</code></pre>
</div>
</div>
<div id="clustering" class="section level1">
<h1 class="hasAnchor">
<a href="#clustering" class="anchor"></a>Clustering</h1>
<div id="performing-snf" class="section level2">
<h2 class="hasAnchor">
<a href="#performing-snf" class="anchor"></a>Performing SNF</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span>scater<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/scater/man/normalize.html">normalize</a></span>(sce_citeseq)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CiteFuse.html">CiteFuse</a></span>(sce_citeseq))</a></code></pre></div>
<pre><code>## Calculating affinity matrix 
## Performing SNF</code></pre>
<pre><code>##    user  system elapsed 
##   3.134   0.175   3.329</code></pre>
</div>
<div id="performing-spectral-clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#performing-spectral-clustering" class="anchor"></a>Performing spectral clustering</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">SNF_W_clust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"SNF_W"</span>]], <span class="dt">K =</span> <span class="dv">20</span>)</a></code></pre></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 20 dimensions</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(SNF_W_clust<span class="op">$</span>eigen_values)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(SNF_W_clust<span class="op">$</span>eigen_values)))</a></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">SNF_W_clust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"SNF_W"</span>]], <span class="dt">K =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">sce_citeseq<span class="op">$</span>SNF_W_clust &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(SNF_W_clust<span class="op">$</span>labels)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"></a>
<a class="sourceLine" id="cb37-5" data-line-number="5">SNF_W1_clust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"ADT_W"</span>]], <span class="dt">K =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">sce_citeseq<span class="op">$</span>ADT_clust &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(SNF_W1_clust<span class="op">$</span>labels)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"></a>
<a class="sourceLine" id="cb39-3" data-line-number="3">SNF_W2_clust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"RNA_W"</span>]], <span class="dt">K =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">sce_citeseq<span class="op">$</span>RNA_clust &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(SNF_W2_clust<span class="op">$</span>labels)</a></code></pre></div>
</div>
<div id="visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#visualisation" class="anchor"></a>Visualisation</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/reducedDimSNF.html">reducedDimSNF</a></span>(sce_citeseq, <span class="dt">method =</span> <span class="st">"tSNE"</span>, <span class="dt">dimNames =</span> <span class="st">"tSNE_joint"</span>)</a>
<a class="sourceLine" id="cb42-2" data-line-number="2"></a>
<a class="sourceLine" id="cb42-3" data-line-number="3">g1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, <span class="dt">dimNames =</span> <span class="st">"tSNE_joint"</span>, <span class="dt">colour_by =</span> <span class="st">"SNF_W_clust"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"tSNE (SNF clustering)"</span>)</a>
<a class="sourceLine" id="cb42-5" data-line-number="5">g2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, <span class="dt">dimNames =</span> <span class="st">"tSNE_joint"</span>,  <span class="dt">colour_by =</span> <span class="st">"ADT_clust"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"tSNE (ADT clustering)"</span>)</a>
<a class="sourceLine" id="cb42-7" data-line-number="7">g3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, <span class="dt">dimNames =</span> <span class="st">"tSNE_joint"</span>,  <span class="dt">colour_by =</span> <span class="st">"RNA_clust"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"tSNE (RNA clustering)"</span>)</a>
<a class="sourceLine" id="cb42-9" data-line-number="9"></a>
<a class="sourceLine" id="cb42-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gridExtra)</a>
<a class="sourceLine" id="cb42-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(g3, g2, g1, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-16-1.png" width="768"></p>
</div>
<div id="louvain-clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#louvain-clustering" class="anchor"></a>Louvain Clustering</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">SNF_W_louvain &lt;-<span class="st"> </span><span class="kw"><a href="../reference/igraphClustering.html">igraphClustering</a></span>(sce_citeseq, <span class="dt">method =</span> <span class="st">"louvain"</span>)</a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(SNF_W_louvain)</a></code></pre></div>
<pre><code>## SNF_W_louvain
##   1   2   3   4   5   6   7   8 
##  29  39  30  36  32 130  88  53</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">sce_citeseq<span class="op">$</span>SNF_W_louvain &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(SNF_W_louvain)</a>
<a class="sourceLine" id="cb45-2" data-line-number="2"></a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="kw"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(sce_citeseq, <span class="dt">dimNames =</span> <span class="st">"tSNE_joint"</span>, <span class="dt">colour_by =</span> <span class="st">"SNF_W_louvain"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"tSNE (SNF louvain clustering)"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseKNN.html">visualiseKNN</a></span>(sce_citeseq, <span class="dt">colour_by =</span> <span class="st">"SNF_W_louvain"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-18-1.png" width="576"></p>
</div>
</div>
<div id="differential-expression-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#differential-expression-analysis" class="anchor"></a>Differential Expression Analysis</h1>
<div id="exploration-of-features-expression" class="section level2">
<h2 class="hasAnchor">
<a href="#exploration-of-features-expression" class="anchor"></a>Exploration of features expression</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">g1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb47-2" data-line-number="2">                     <span class="dt">plot =</span> <span class="st">"boxplot"</span>, </a>
<a class="sourceLine" id="cb47-3" data-line-number="3">                     <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</a>
<a class="sourceLine" id="cb47-4" data-line-number="4">g2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb47-5" data-line-number="5">                     <span class="dt">plot =</span> <span class="st">"violin"</span>, </a>
<a class="sourceLine" id="cb47-6" data-line-number="6">                     <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</a>
<a class="sourceLine" id="cb47-7" data-line-number="7">g3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb47-8" data-line-number="8">                     <span class="dt">plot =</span> <span class="st">"jitter"</span>, </a>
<a class="sourceLine" id="cb47-9" data-line-number="9">                     <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</a>
<a class="sourceLine" id="cb47-10" data-line-number="10">g4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb47-11" data-line-number="11">                     <span class="dt">plot =</span> <span class="st">"density"</span>, </a>
<a class="sourceLine" id="cb47-12" data-line-number="12">                     <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</a>
<a class="sourceLine" id="cb47-13" data-line-number="13"></a>
<a class="sourceLine" id="cb47-14" data-line-number="14"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gridExtra)</a>
<a class="sourceLine" id="cb47-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(g1, g2, g3, g4, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-19-1.png" width="768"></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, <span class="dt">transform =</span> <span class="st">"log"</span>)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb48-3" data-line-number="3">               <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb48-4" data-line-number="4">               <span class="dt">n =</span> <span class="dv">30</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-20-1.png" width="768"></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">g1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb49-2" data-line-number="2">                     <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb49-3" data-line-number="3">                     <span class="dt">plot =</span> <span class="st">"violin"</span>, <span class="dt">n =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb49-4" data-line-number="4">g2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb49-5" data-line-number="5">                     <span class="dt">plot =</span> <span class="st">"jitter"</span>, </a>
<a class="sourceLine" id="cb49-6" data-line-number="6">                     <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD2"</span>, <span class="st">"CD8"</span>, <span class="st">"CD4"</span>, <span class="st">"CD19"</span>))</a>
<a class="sourceLine" id="cb49-7" data-line-number="7">g3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb49-8" data-line-number="8">                     <span class="dt">plot =</span> <span class="st">"density"</span>, </a>
<a class="sourceLine" id="cb49-9" data-line-number="9">                     <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD2"</span>, <span class="st">"CD8"</span>, <span class="st">"CD4"</span>, <span class="st">"CD19"</span>))</a>
<a class="sourceLine" id="cb49-10" data-line-number="10"></a>
<a class="sourceLine" id="cb49-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(g1, g2, g3, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-20-2.png" width="768"></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb50-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"boxplot"</span>, </a>
<a class="sourceLine" id="cb50-3" data-line-number="3">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD2"</span>, <span class="st">"CD8"</span>, <span class="st">"CD4"</span>, <span class="st">"CD19"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>sce_citeseq<span class="op">$</span>SNF_W_louvain, <span class="dt">nrow =</span> <span class="dv">7</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-21-1.png" width="768"></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb51-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"pairwise"</span>, </a>
<a class="sourceLine" id="cb51-3" data-line-number="3">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD4"</span>, <span class="st">"CD8"</span>))</a></code></pre></div>
<pre><code>## number of iterations= 12 
## number of iterations= 130</code></pre>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-22-1.png" width="768"></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="kw"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(sce_citeseq, <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb53-2" data-line-number="2">               <span class="dt">plot =</span> <span class="st">"pairwise"</span>, </a>
<a class="sourceLine" id="cb53-3" data-line-number="3">               <span class="dt">feature_subset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD45RA"</span>, <span class="st">"CD4"</span>, <span class="st">"CD8"</span>), <span class="dt">threshold =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">4</span>, <span class="dv">3</span>))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-22-2.png" width="768"></p>
</div>
<div id="perform-de-analysis-using-wilcoxon-rank-sum-test" class="section level2">
<h2 class="hasAnchor">
<a href="#perform-de-analysis-using-wilcoxon-rank-sum-test" class="anchor"></a>Perform DE analysis using Wilcoxon Rank Sum test</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">rna_DEgenes_all &lt;-<span class="st"> </span><span class="kw"><a href="../reference/DEgenes.html">DEgenes</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">                           <span class="dt">group =</span> sce_citeseq<span class="op">$</span>SNF_W_louvain,</a>
<a class="sourceLine" id="cb54-3" data-line-number="3">                           <span class="dt">return_all =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">                           <span class="dt">exprs_pct =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb54-5" data-line-number="5"></a>
<a class="sourceLine" id="cb54-6" data-line-number="6"></a>
<a class="sourceLine" id="cb54-7" data-line-number="7">rna_DEgenes &lt;-<span class="st"> </span><span class="kw"><a href="../reference/selectDEgenes.html">selectDEgenes</a></span>(rna_DEgenes_all)</a>
<a class="sourceLine" id="cb54-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(rbind, rna_DEgenes), <span class="dt">digits =</span> <span class="dv">2</span>))</a></code></pre></div>
<div id="htmlwidget-88d000521439057f9513" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-88d000521439057f9513">{"x":{"filter":"none","data":[["1.hg19_CCR7","1.hg19_ACTN1","1.hg19_NELL2","1.hg19_PASK","1.hg19_MAL","1.hg19_CD8B","1.hg19_LEF1","1.hg19_PIK3IP1","1.hg19_LDLRAP1","1.hg19_PCED1B","2.hg19_CD8B","2.hg19_CMC1","2.hg19_CCL5","2.hg19_CD8A","2.hg19_GZMM","2.hg19_DUSP2","2.hg19_NDUFA6","2.hg19_HCST","2.hg19_KLRG1","2.hg19_RNF166","3.hg19_GZMK","3.hg19_KLRB1","3.hg19_DUSP2","3.hg19_IL7R","3.hg19_NCR3","3.hg19_CEBPD","3.hg19_KLRG1","3.hg19_CD69","3.hg19_LINC01871","3.hg19_IL32","4.hg19_FCN1","4.hg19_LYZ","4.hg19_SPI1","4.hg19_CYBB","4.hg19_S100A9","4.hg19_HLA-DRA","4.hg19_CD68","4.hg19_S100A8","4.hg19_CSTA","4.hg19_VCAN","5.hg19_IL7R","5.hg19_S100A4","5.hg19_S100A10","5.hg19_IL32","5.hg19_RORA","5.hg19_FAM107B","5.hg19_ITGB1","5.hg19_EML4","5.hg19_CD6","5.hg19_CD44","6.hg19_CD8A","6.hg19_ZNF683","6.hg19_GZMH","6.hg19_CCL5","6.hg19_GNLY","6.hg19_FGFBP2","6.hg19_GZMB","6.hg19_CST7","6.hg19_KLRD1","6.hg19_NKG7","7.hg19_LTB","7.hg19_TCF7","7.hg19_IL7R","7.hg19_CD27","7.hg19_LDHB","7.hg19_LEF1","7.hg19_SELL","7.hg19_NPM1","7.hg19_NOSIP","7.hg19_CAMK4","8.hg19_SH2D1B","8.hg19_KLRF1","8.hg19_CLIC3","8.hg19_MYOM2","8.hg19_FCER1G","8.hg19_TRDC","8.hg19_SPON2","8.hg19_TYROBP","8.hg19_IL2RB","8.hg19_KLRB1"],["2449","2815","2907","3163","3115","2175","2384","2787","3260","3524","3324","4046","3228","4153","4580","5093","5461","5142","5550","5581","2668"," 850","2126","2159","3396","3393","2878","3109","3983","3478","2206","2211","2214","2406","2614"," 669","3008","2630","3208","3208","2594","3374","3682","3807","4564","4536","4478","4754","4726","4655","5456","9806","6266","5918","6689","7716","7956","7816","8654","7861","3778","5778","5710","8479","5946","8339","8482","7150","8192","9504","3566","2719","3450","1996","3698","4270","2856","2812","3343","3370"],["3.0e-21","3.7e-19","8.1e-19","1.6e-18","1.4e-13","2.8e-13","5.0e-13","5.0e-11","1.5e-10","2.7e-10","3.9e-14","4.4e-10","7.4e-10","1.8e-07","4.0e-06","5.3e-05","3.3e-04","4.7e-04","4.8e-04","5.2e-04","7.8e-24","2.5e-23","1.1e-11","1.2e-10","1.6e-10","3.2e-10","9.2e-09","2.5e-07","7.5e-06","7.6e-05","5.8e-66","1.7e-63","2.0e-63","2.9e-63","4.6e-58","6.3e-58","3.3e-55","1.3e-53","1.5e-52","1.5e-52","7.5e-10","6.3e-06","4.2e-05","9.3e-05","1.1e-03","1.4e-03","1.6e-03","2.8e-03","2.9e-03","3.5e-03","3.9e-39","5.0e-36","5.4e-35","1.3e-32","1.6e-29","3.4e-29","6.3e-27","5.5e-25","1.0e-24","1.3e-24","4.9e-34","3.2e-29","3.2e-23","2.3e-21","2.7e-20","5.2e-19","2.9e-15","6.2e-15","1.5e-14","1.6e-13","3.0e-54","2.0e-38","3.8e-35","1.0e-34","1.0e-32","4.0e-32","5.7e-28","1.2e-27","5.0e-25","1.8e-23"],["3.0e-21","3.7e-19","8.1e-19","1.6e-18","1.4e-13","2.8e-13","5.0e-13","5.0e-11","1.5e-10","2.7e-10","3.9e-14","4.4e-10","7.4e-10","1.8e-07","4.0e-06","5.3e-05","3.3e-04","4.7e-04","4.8e-04","5.2e-04","7.8e-24","2.5e-23","1.1e-11","1.2e-10","1.6e-10","3.2e-10","9.2e-09","2.5e-07","7.5e-06","7.6e-05","5.8e-66","1.7e-63","2.0e-63","2.9e-63","4.6e-58","6.3e-58","3.3e-55","1.3e-53","1.5e-52","1.5e-52","7.5e-10","6.3e-06","4.2e-05","9.3e-05","1.1e-03","1.4e-03","1.6e-03","2.8e-03","2.9e-03","3.5e-03","3.9e-39","5.0e-36","5.4e-35","1.3e-32","1.6e-29","3.4e-29","6.3e-27","5.5e-25","1.0e-24","1.3e-24","4.9e-34","3.2e-29","3.2e-23","2.3e-21","2.7e-20","5.2e-19","2.9e-15","6.2e-15","1.5e-14","1.6e-13","3.0e-54","2.0e-38","3.8e-35","1.0e-34","1.0e-32","4.0e-32","5.7e-28","1.2e-27","5.0e-25","1.8e-23"],["0.0890","0.0690","0.0740","0.0513","0.1080","0.3614","0.2537","0.2096","0.1353","0.0991","0.3526","0.4035","2.0049","0.8254","0.5951","0.5419","0.3671","1.3543","0.4768","0.3657","0.1088","0.4686","0.5104","0.9285","0.1657","0.2075","0.4686","0.4013","0.2302","1.7839","0.0000","0.0016","0.0027","0.0000","0.0020","0.0574","0.0000","0.0079","0.0000","0.0000","0.9345","2.3209","1.2816","1.7825","0.4297","0.4573","0.6891","0.3681","0.4142","0.5453","0.4647","0.0474","0.5247","1.4916","1.8386","0.4825","0.6822","1.1425","0.5112","1.7027","0.5647","0.2360","0.7507","0.1172","0.7219","0.1807","0.3341","1.2433","0.3780","0.1817","0.0146","0.1257","0.0899","0.2414","0.1816","0.0919","0.2749","0.4635","0.2221","0.4423"],["0.82","0.65","0.56","0.51","0.60","1.57","1.09","0.86","0.66","0.46","1.35","1.43","3.79","1.73","1.22","1.10","0.75","1.94","1.01","0.75","0.92","2.80","1.69","2.53","0.81","0.94","1.28","1.07","0.69","2.67","1.88","2.82","1.17","0.83","2.60","2.87","0.76","2.89","1.07","1.54","2.36","3.31","1.96","2.63","0.84","0.80","1.18","0.77","0.74","0.93","1.95","0.85","2.00","3.75","4.66","1.72","2.05","2.64","1.56","3.81","2.39","1.19","2.18","0.64","1.78","0.82","1.04","2.07","1.03","0.62","0.92","1.23","1.41","1.84","1.67","0.96","1.77","2.09","1.31","1.98"],["0.0784","0.0686","0.0637","0.0515","0.0931","0.2304","0.1985","0.1838","0.1275","0.0980","0.2186","0.2412","0.6131","0.4171","0.4271","0.3593","0.3291","0.7563","0.3166","0.3065","0.0565","0.2285","0.3489","0.4251","0.1278","0.1351","0.2998","0.3464","0.1843","0.7617","0.0000","0.0025","0.0025","0.0000","0.0025","0.0474","0.0000","0.0075","0.0000","0.0000","0.4222","0.8938","0.7432","0.7654","0.3358","0.3802","0.4568","0.3160","0.3358","0.4222","0.2736","0.0293","0.2769","0.4984","0.4723","0.2606","0.2997","0.4756","0.2899","0.5049","0.2951","0.1748","0.3352","0.1003","0.5129","0.1461","0.2264","0.7221","0.3123","0.1633","0.0104","0.0911","0.0807","0.1745","0.0781","0.0573","0.1875","0.1797","0.1849","0.2005"],["0.66","0.59","0.59","0.52","0.59","0.79","0.76","0.72","0.55","0.52","0.77","0.67","1.00","0.90","0.77","0.67","0.54","0.92","0.54","0.54","0.63","0.97","0.90","0.93","0.57","0.57","0.83","0.77","0.53","1.00","0.69","0.69","0.69","0.67","0.64","0.92","0.58","0.64","0.56","0.56","0.94","1.00","0.97","0.94","0.59","0.62","0.69","0.53","0.59","0.69","0.90","0.54","0.90","1.00","1.00","0.84","0.89","0.99","0.82","1.00","0.93","0.77","0.95","0.55","0.85","0.59","0.66","0.95","0.70","0.55","0.66","0.81","0.70","0.89","0.72","0.64","0.81","0.94","0.77","0.85"],["0.58","0.52","0.52","0.47","0.49","0.56","0.56","0.54","0.42","0.42","0.55","0.43","0.39","0.48","0.34","0.31","0.21","0.17","0.22","0.23","0.58","0.74","0.55","0.51","0.44","0.43","0.53","0.42","0.35","0.24","0.69","0.69","0.69","0.67","0.64","0.87","0.58","0.63","0.56","0.56","0.52","0.11","0.23","0.17","0.26","0.24","0.23","0.22","0.26","0.27","0.63","0.51","0.62","0.50","0.53","0.58","0.59","0.52","0.53","0.50","0.64","0.60","0.62","0.45","0.34","0.44","0.43","0.23","0.39","0.38","0.65","0.72","0.62","0.71","0.64","0.58","0.62","0.76","0.59","0.65"],["0.58","0.52","0.52","0.47","0.49","0.56","0.56","0.54","0.42","0.42","0.55","0.43","0.39","0.48","0.34","0.31","0.21","0.17","0.22","0.23","0.58","0.74","0.55","0.51","0.44","0.43","0.53","0.42","0.35","0.24","0.69","0.69","0.69","0.67","0.64","0.87","0.58","0.63","0.56","0.56","0.52","0.11","0.23","0.17","0.26","0.24","0.23","0.22","0.26","0.27","0.63","0.51","0.62","0.50","0.53","0.58","0.59","0.52","0.53","0.50","0.64","0.60","0.62","0.45","0.34","0.44","0.43","0.23","0.39","0.38","0.65","0.72","0.62","0.71","0.64","0.58","0.62","0.76","0.59","0.65"],["hg19_CCR7","hg19_ACTN1","hg19_NELL2","hg19_PASK","hg19_MAL","hg19_CD8B","hg19_LEF1","hg19_PIK3IP1","hg19_LDLRAP1","hg19_PCED1B","hg19_CD8B","hg19_CMC1","hg19_CCL5","hg19_CD8A","hg19_GZMM","hg19_DUSP2","hg19_NDUFA6","hg19_HCST","hg19_KLRG1","hg19_RNF166","hg19_GZMK","hg19_KLRB1","hg19_DUSP2","hg19_IL7R","hg19_NCR3","hg19_CEBPD","hg19_KLRG1","hg19_CD69","hg19_LINC01871","hg19_IL32","hg19_FCN1","hg19_LYZ","hg19_SPI1","hg19_CYBB","hg19_S100A9","hg19_HLA-DRA","hg19_CD68","hg19_S100A8","hg19_CSTA","hg19_VCAN","hg19_IL7R","hg19_S100A4","hg19_S100A10","hg19_IL32","hg19_RORA","hg19_FAM107B","hg19_ITGB1","hg19_EML4","hg19_CD6","hg19_CD44","hg19_CD8A","hg19_ZNF683","hg19_GZMH","hg19_CCL5","hg19_GNLY","hg19_FGFBP2","hg19_GZMB","hg19_CST7","hg19_KLRD1","hg19_NKG7","hg19_LTB","hg19_TCF7","hg19_IL7R","hg19_CD27","hg19_LDHB","hg19_LEF1","hg19_SELL","hg19_NPM1","hg19_NOSIP","hg19_CAMK4","hg19_SH2D1B","hg19_KLRF1","hg19_CLIC3","hg19_MYOM2","hg19_FCER1G","hg19_TRDC","hg19_SPON2","hg19_TYROBP","hg19_IL2RB","hg19_KLRB1"],["1","1","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","2","3","3","3","3","3","3","3","3","3","3","4","4","4","4","4","4","4","4","4","4","5","5","5","5","5","5","5","5","5","5","6","6","6","6","6","6","6","6","6","6","7","7","7","7","7","7","7","7","7","7","8","8","8","8","8","8","8","8","8","8"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>stats.W<\/th>\n      <th>pval<\/th>\n      <th>p.adjust<\/th>\n      <th>meanExprs.1<\/th>\n      <th>meanExprs.2<\/th>\n      <th>meanPct.1<\/th>\n      <th>meanPct.2<\/th>\n      <th>meanDiff<\/th>\n      <th>pctDiff<\/th>\n      <th>name<\/th>\n      <th>group<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">adt_DEgenes_all &lt;-<span class="st"> </span><span class="kw"><a href="../reference/DEgenes.html">DEgenes</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb55-2" data-line-number="2">                           <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>,</a>
<a class="sourceLine" id="cb55-3" data-line-number="3">                           <span class="dt">group =</span> sce_citeseq<span class="op">$</span>SNF_W_louvain,</a>
<a class="sourceLine" id="cb55-4" data-line-number="4">                           <span class="dt">exprs_threshold =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb55-5" data-line-number="5">                           <span class="dt">return_all =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb55-6" data-line-number="6">                           <span class="dt">exprs_pct =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb55-7" data-line-number="7"></a>
<a class="sourceLine" id="cb55-8" data-line-number="8">adt_DEgenes &lt;-<span class="st"> </span><span class="kw"><a href="../reference/selectDEgenes.html">selectDEgenes</a></span>(adt_DEgenes_all)</a>
<a class="sourceLine" id="cb55-9" data-line-number="9"></a>
<a class="sourceLine" id="cb55-10" data-line-number="10"></a>
<a class="sourceLine" id="cb55-11" data-line-number="11"></a>
<a class="sourceLine" id="cb55-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(rbind, adt_DEgenes), <span class="dt">digits =</span> <span class="dv">2</span>))</a></code></pre></div>
<div id="htmlwidget-c27ad8edcf4128775f8f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c27ad8edcf4128775f8f">{"x":{"filter":"none","data":[["1.CD27","1.PECAM (CD31)","1.CD8","1.CD62L","1.CD7","1.CD5","2.CD8","2.PECAM (CD31)","2.CD27","3","4.MHCII (HLA-DR)","4.HLA-A,B,C","4.CD19","4.CD69","4.PECAM (CD31)","4.PD-1 (CD279)","4.CCR7","4.CD11c","4.CD77","4.CD11b","5.CD4","5.CD5","6.CD8","6.CD2","7.CD4","7.CD27","7.CD5","7.CD62L","8.CD7","8.CD11b","8.PECAM (CD31)"],["  841"," 1456"," 2582"," 2764"," 2886"," 4368"," 3781"," 5280"," 5708"," 4372","    3","  478","  691","  930","  960"," 1146"," 1466"," 1810"," 2203"," 2664"," 1344"," 3992"," 4200","12423"," 1607"," 3235"," 6182","10856"," 2401"," 2717"," 6428"],["1.1e-14","1.1e-11","3.9e-07","1.5e-06","4.0e-06","1.8e-02","1.2e-07","9.7e-04","6.4e-03","9.4e-03","1.8e-23","1.6e-20","1.3e-19","2.7e-18","6.4e-18","4.6e-17","2.2e-15","6.8e-14","4.9e-12","3.3e-10","6.7e-14","3.0e-04","5.5e-39","4.4e-10","8.1e-39","2.2e-30","4.5e-18","2.0e-05","1.9e-19","4.5e-18","1.4e-05"],["1.1e-14","1.1e-11","3.9e-07","1.5e-06","4.0e-06","1.8e-02","1.2e-07","9.7e-04","6.4e-03","9.4e-03","1.8e-23","1.6e-20","1.3e-19","2.7e-18","6.4e-18","4.6e-17","2.2e-15","6.8e-14","4.9e-12","3.3e-10","6.7e-14","3.0e-04","5.5e-39","4.4e-10","8.1e-39","2.2e-30","4.5e-18","2.0e-05","1.9e-19","4.5e-18","1.4e-05"],["3.2","2.9","3.7","1.9","3.6","3.6","3.7","3.0","3.3","3.4","1.5","3.5","1.3","1.4","2.8","1.7","2.6","1.6","3.9","2.2","2.4","3.6","2.9","5.5","1.9","2.9","3.4","1.8","3.5","2.3","3.0"],["6.2","4.9","6.0","3.2","4.6","4.0","5.9","3.6","4.5","4.5","6.1","5.3","3.5","3.9","6.3","4.1","3.7","4.2","4.7","5.1","5.8","4.2","6.0","6.2","5.8","5.7","4.4","2.6","4.9","3.6","3.6"],["0.3627","0.2132","0.5025","0.0882","0.4216","0.3848","0.4899","0.2337","0.3643","0.3808","0.0125","0.1771","0.0000","0.0000","0.2045","0.0025","0.0000","0.0000","0.4314","0.0449","0.2691","0.3802","0.3453","0.8827","0.1519","0.2607","0.3181","0.0688","0.3750","0.0729","0.2396"],["1.00","0.90","1.00","0.34","0.79","0.62","1.00","0.51","0.82","0.73","1.00","0.94","0.36","0.61","0.86","0.56","0.19","0.69","0.86","0.64","1.00","0.66","0.98","1.00","1.00","0.98","0.73","0.25","0.96","0.25","0.40"],["0.64","0.68","0.50","0.26","0.37","0.24","0.51","0.28","0.46","0.35","0.99","0.77","0.36","0.61","0.66","0.55","0.19","0.69","0.43","0.59","0.73","0.28","0.64","0.12","0.85","0.72","0.41","0.18","0.59","0.17","0.16"],["0.64","0.68","0.50","0.26","0.37","0.24","0.51","0.28","0.46","0.35","0.99","0.77","0.36","0.61","0.66","0.55","0.19","0.69","0.43","0.59","0.73","0.28","0.64","0.12","0.85","0.72","0.41","0.18","0.59","0.17","0.16"],["CD27","PECAM (CD31)","CD8","CD62L","CD7","CD5","CD8","PECAM (CD31)","CD27","CD27","MHCII (HLA-DR)","HLA-A,B,C","CD19","CD69","PECAM (CD31)","PD-1 (CD279)","CCR7","CD11c","CD77","CD11b","CD4","CD5","CD8","CD2","CD4","CD27","CD5","CD62L","CD7","CD11b","PECAM (CD31)"],["1","1","1","1","1","1","2","2","2","3","4","4","4","4","4","4","4","4","4","4","5","5","6","6","7","7","7","7","8","8","8"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>stats.W<\/th>\n      <th>pval<\/th>\n      <th>p.adjust<\/th>\n      <th>meanExprs.1<\/th>\n      <th>meanExprs.2<\/th>\n      <th>meanPct.1<\/th>\n      <th>meanPct.2<\/th>\n      <th>meanDiff<\/th>\n      <th>pctDiff<\/th>\n      <th>name<\/th>\n      <th>group<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="visualising-de-results" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-de-results" class="anchor"></a>Visualising DE results</h2>
<div id="circlepackplot" class="section level3">
<h3 class="hasAnchor">
<a href="#circlepackplot" class="anchor"></a>circlepackPlot</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">rna_DEgenes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(rna_DEgenes, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb56-2" data-line-number="2">  x<span class="op">$</span>name &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"hg19_"</span>, <span class="st">""</span>, x<span class="op">$</span>name)</a>
<a class="sourceLine" id="cb56-3" data-line-number="3">  x</a>
<a class="sourceLine" id="cb56-4" data-line-number="4">})</a>
<a class="sourceLine" id="cb56-5" data-line-number="5"><span class="kw"><a href="../reference/DEbubblePlot.html">DEbubblePlot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">RNA =</span> rna_DEgenes, <span class="dt">ADT =</span> adt_DEgenes))</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-25-1.png" width="960"></p>
</div>
<div id="decomparisonplot" class="section level3">
<h3 class="hasAnchor">
<a href="#decomparisonplot" class="anchor"></a>DEcomparisonPlot</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">rna_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD4"</span>,</a>
<a class="sourceLine" id="cb57-2" data-line-number="2">              <span class="st">"hg19_CD8A"</span>,</a>
<a class="sourceLine" id="cb57-3" data-line-number="3">              <span class="st">"hg19_HLA-DRB1"</span>,</a>
<a class="sourceLine" id="cb57-4" data-line-number="4">              <span class="st">"hg19_ITGAX"</span>,</a>
<a class="sourceLine" id="cb57-5" data-line-number="5">              <span class="st">"hg19_NCAM1"</span>,</a>
<a class="sourceLine" id="cb57-6" data-line-number="6">              <span class="st">"hg19_CD27"</span>,</a>
<a class="sourceLine" id="cb57-7" data-line-number="7">              <span class="st">"hg19_CD19"</span>)</a>
<a class="sourceLine" id="cb57-8" data-line-number="8"></a>
<a class="sourceLine" id="cb57-9" data-line-number="9">adt_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD4"</span>, <span class="st">"CD8"</span>, <span class="st">"MHCII (HLA-DR)"</span>, <span class="st">"CD11c"</span>, <span class="st">"CD56"</span>, <span class="st">"CD27"</span>, <span class="st">"CD19"</span>)</a>
<a class="sourceLine" id="cb57-10" data-line-number="10"></a>
<a class="sourceLine" id="cb57-11" data-line-number="11">feature_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">RNA =</span> rna_list, <span class="dt">ADT =</span> adt_list)</a>
<a class="sourceLine" id="cb57-12" data-line-number="12">de_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">RNA =</span> rna_DEgenes_all, <span class="dt">ADT =</span> adt_DEgenes_all)</a>
<a class="sourceLine" id="cb57-13" data-line-number="13"></a>
<a class="sourceLine" id="cb57-14" data-line-number="14"><span class="kw"><a href="../reference/DEcomparisonPlot.html">DEcomparisonPlot</a></span>(<span class="dt">de_list =</span> de_list,</a>
<a class="sourceLine" id="cb57-15" data-line-number="15">                 <span class="dt">feature_list =</span> feature_list)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-26-1.png" width="960"></p>
</div>
</div>
</div>
<div id="adt-importance-evaluation" class="section level1">
<h1 class="hasAnchor">
<a href="#adt-importance-evaluation" class="anchor"></a>ADT importance evaluation</h1>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/importanceADT.html">importanceADT</a></span>(sce_citeseq, </a>
<a class="sourceLine" id="cb58-2" data-line-number="2">                             <span class="dt">group =</span> sce_citeseq<span class="op">$</span>SNF_W_louvain,</a>
<a class="sourceLine" id="cb58-3" data-line-number="3">                             <span class="dt">subsample =</span> T)</a>
<a class="sourceLine" id="cb58-4" data-line-number="4"></a>
<a class="sourceLine" id="cb58-5" data-line-number="5"><span class="kw"><a href="../reference/visImportance.html">visImportance</a></span>(sce_citeseq, <span class="dt">plot =</span> <span class="st">"boxplot"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-27-1.png" width="768"></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw"><a href="../reference/visImportance.html">visImportance</a></span>(sce_citeseq, <span class="dt">plot =</span> <span class="st">"heatmap"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-27-2.png" width="768"></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"importanceADT"</span>]], <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]</a></code></pre></div>
<pre><code>##              CD27               CD8               CD4      PECAM (CD31) 
##         33.975808         33.077846         32.160118         15.758429 
##               CD5               CD7             CD11b              CD28 
##         12.502951         12.493933         11.889148         11.805653 
##               CD2 IL7Ralpha (CD127)    MHCII (HLA-DR)              CD44 
##         10.465394         10.313923          9.056652          8.122781 
##         HLA-A,B,C      CD366 (tim3)            CD45RA             CD62L 
##          6.966416          5.278447          4.967405          4.910027 
##             CD11c               CD3       PD1 (CD279)              CD69 
##          4.865862          4.811810          4.373719          4.226415</code></pre>
<p>Select the ADT with scores greater than 5 and perform SNF again</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">subset_adt &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"importanceADT"</span>]] <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">subset_adt</a></code></pre></div>
<pre><code>##  [1] "CD11b"             "CD2"               "CD27"             
##  [4] "CD28"              "CD366 (tim3)"      "CD4"              
##  [7] "CD44"              "CD5"               "CD7"              
## [10] "CD8"               "HLA-A,B,C"         "IL7Ralpha (CD127)"
## [13] "MHCII (HLA-DR)"    "PECAM (CD31)"</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CiteFuse.html">CiteFuse</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb64-2" data-line-number="2">                                    <span class="dt">ADT_subset =</span> subset_adt,</a>
<a class="sourceLine" id="cb64-3" data-line-number="3">                                    <span class="dt">metadata_names =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"W_SNF_adtSubset1"</span>,</a>
<a class="sourceLine" id="cb64-4" data-line-number="4">                                                       <span class="st">"W_ADT_adtSubset1"</span>,</a>
<a class="sourceLine" id="cb64-5" data-line-number="5">                                                       <span class="st">"W_RNA"</span></a>
<a class="sourceLine" id="cb64-6" data-line-number="6">                                    )))</a></code></pre></div>
<pre><code>## Calculating affinity matrix 
## Performing SNF</code></pre>
<pre><code>##    user  system elapsed 
##   1.656   0.055   1.711</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">SNF_W_clust_adtSubset1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="kw">metadata</span>(sce_citeseq)[[<span class="st">"W_SNF_adtSubset1"</span>]], <span class="dt">K =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1">sce_citeseq<span class="op">$</span>SNF_W_clust_adtSubset1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(SNF_W_clust_adtSubset1<span class="op">$</span>labels)</a>
<a class="sourceLine" id="cb69-2" data-line-number="2"></a>
<a class="sourceLine" id="cb69-3" data-line-number="3"></a>
<a class="sourceLine" id="cb69-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mclust)</a>
<a class="sourceLine" id="cb69-5" data-line-number="5"><span class="kw"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span>(sce_citeseq<span class="op">$</span>SNF_W_clust_adtSubset1, sce_citeseq<span class="op">$</span>SNF_W_clust)</a></code></pre></div>
<pre><code>## [1] 0.9305567</code></pre>
</div>
<div id="gene---adt-network" class="section level1">
<h1 class="hasAnchor">
<a href="#gene---adt-network" class="anchor"></a>Gene - ADT network</h1>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1">RNA_feature_subset &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(rna_DEgenes_all, <span class="st">"[["</span>, <span class="st">"name"</span>))))</a>
<a class="sourceLine" id="cb71-2" data-line-number="2">ADT_feature_subset &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(adt_DEgenes_all, <span class="st">"[["</span>, <span class="st">"name"</span>))))</a>
<a class="sourceLine" id="cb71-3" data-line-number="3"></a>
<a class="sourceLine" id="cb71-4" data-line-number="4"><span class="kw"><a href="../reference/geneADTnetwork.html">geneADTnetwork</a></span>(sce_citeseq,</a>
<a class="sourceLine" id="cb71-5" data-line-number="5">               <span class="dt">RNA_feature_subset =</span> RNA_feature_subset,</a>
<a class="sourceLine" id="cb71-6" data-line-number="6">               <span class="dt">ADT_feature_subset =</span> ADT_feature_subset,</a>
<a class="sourceLine" id="cb71-7" data-line-number="7">               <span class="dt">cor_method =</span> <span class="st">"pearson"</span>,</a>
<a class="sourceLine" id="cb71-8" data-line-number="8">               <span class="dt">network_layout =</span> igraph<span class="op">::</span>layout_with_fr)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-29-1.png" width="768"></p>
<pre><code>## IGRAPH e8393da UN-B 67 115 -- 
## + attr: name (v/c), label (v/c), class (v/c), type (v/l), shape (v/c),
## | color (v/c), size (v/n), label.cex (v/n), label.color (v/c), value
## | (e/n), color (e/c), weights (e/n)
## + edges from e8393da (vertex names):
##  [1] RNA_hg19_RPS8  --ADT_CD27 RNA_hg19_TCF7  --ADT_CD27
##  [3] RNA_hg19_RPL37 --ADT_CD27 RNA_hg19_CD27  --ADT_CD27
##  [5] RNA_hg19_LTB   --ADT_CD27 RNA_hg19_IL7R  --ADT_CD27
##  [7] RNA_hg19_RPS12 --ADT_CD27 RNA_hg19_RPL13 --ADT_CD27
##  [9] RNA_hg19_RPL32 --ADT_CD27 RNA_hg19_RPL11 --ADT_CD27
## [11] RNA_hg19_CCL5  --ADT_CD27 RNA_hg19_GZMH  --ADT_CD27
## + ... omitted several edges</code></pre>
</div>
<div id="rna-ligand---adt-receptor-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#rna-ligand---adt-receptor-analysis" class="anchor"></a>RNA Ligand - ADT Receptor Analysis</h1>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"lr_pair_subset"</span>, <span class="dt">package =</span> <span class="st">"CiteFuse"</span>)</a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(lr_pair_subset)</a></code></pre></div>
<pre><code>##      [,1]          [,2]   
## [1,] "hg19_IL17RA" "CD45" 
## [2,] "hg19_FAS"    "CD11b"
## [3,] "hg19_GZMK"   "CD62L"
## [4,] "hg19_CD40LG" "CD11b"
## [5,] "hg19_FLT3LG" "CD62L"
## [6,] "hg19_GZMA"   "CD19"</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(<span class="dt">sce =</span> sce_citeseq, </a>
<a class="sourceLine" id="cb75-2" data-line-number="2">                              <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>, </a>
<a class="sourceLine" id="cb75-3" data-line-number="3">                              <span class="dt">transform =</span> <span class="st">"zi_minMax"</span>)</a>
<a class="sourceLine" id="cb75-4" data-line-number="4"></a>
<a class="sourceLine" id="cb75-5" data-line-number="5">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(<span class="dt">sce =</span> sce_citeseq, </a>
<a class="sourceLine" id="cb75-6" data-line-number="6">                              <span class="dt">altExp_name =</span> <span class="st">"none"</span>, </a>
<a class="sourceLine" id="cb75-7" data-line-number="7">                              <span class="dt">exprs_value =</span> <span class="st">"logcounts"</span>,</a>
<a class="sourceLine" id="cb75-8" data-line-number="8">                              <span class="dt">transform =</span> <span class="st">"minMax"</span>)</a>
<a class="sourceLine" id="cb75-9" data-line-number="9"></a>
<a class="sourceLine" id="cb75-10" data-line-number="10">sce_citeseq &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ligandReceptorTest.html">ligandReceptorTest</a></span>(<span class="dt">sce =</span> sce_citeseq,</a>
<a class="sourceLine" id="cb75-11" data-line-number="11">                                  <span class="dt">ligandReceptor_list =</span> lr_pair_subset,</a>
<a class="sourceLine" id="cb75-12" data-line-number="12">                                  <span class="dt">cluster =</span> sce_citeseq<span class="op">$</span>SNF_W_louvain,</a>
<a class="sourceLine" id="cb75-13" data-line-number="13">                                  <span class="dt">RNA_exprs_value =</span> <span class="st">"minMax"</span>,</a>
<a class="sourceLine" id="cb75-14" data-line-number="14">                                  <span class="dt">altExp_name =</span> <span class="st">"ADT"</span>,</a>
<a class="sourceLine" id="cb75-15" data-line-number="15">                                  <span class="dt">altExp_exprs_value =</span> <span class="st">"zi_minMax"</span>,</a>
<a class="sourceLine" id="cb75-16" data-line-number="16">                                  <span class="dt">num_permute =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb75-17" data-line-number="17">                                  <span class="dt">ncores =</span> <span class="dv">1</span>) </a></code></pre></div>
<pre><code>## 100 ......200 ......300 ......400 ......500 ......600 ......700 ......800 ......900 ......1000 ......</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(sce_citeseq, <span class="dt">type =</span> <span class="st">"pval_heatmap"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-31-1.png" width="768"></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(sce_citeseq, <span class="dt">type =</span> <span class="st">"pval_dotplot"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-32-1.png" width="576"></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(sce_citeseq, <span class="dt">type =</span> <span class="st">"group_network"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-33-1.png" width="768"></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="kw"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(sce_citeseq, <span class="dt">type =</span> <span class="st">"group_heatmap"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-34-1.png" width="768"></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(sce_citeseq, <span class="dt">type =</span> <span class="st">"lr_network"</span>)</a></code></pre></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-35-1.png" width="768"></p>
</div>
<div id="sessioninfo" class="section level1">
<h1 class="hasAnchor">
<a href="#sessioninfo" class="anchor"></a>SessionInfo</h1>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</a></code></pre></div>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.3
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] mclust_5.4.5                gridExtra_2.3              
##  [3] DT_0.10                     scater_1.14.4              
##  [5] ggplot2_3.2.1               SingleCellExperiment_1.8.0 
##  [7] SummarizedExperiment_1.16.0 DelayedArray_0.12.0        
##  [9] BiocParallel_1.20.0         matrixStats_0.55.0         
## [11] Biobase_2.46.0              GenomicRanges_1.38.0       
## [13] GenomeInfoDb_1.22.0         IRanges_2.20.1             
## [15] S4Vectors_0.24.3            BiocGenerics_0.32.0        
## [17] CiteFuse_0.1.0             
## 
## loaded via a namespace (and not attached):
##   [1] Rtsne_0.15               ggbeeswarm_0.6.0         colorspace_1.4-1        
##   [4] ggridges_0.5.1           rprojroot_1.3-2          XVector_0.26.0          
##   [7] BiocNeighbors_1.4.1      fs_1.3.1                 rstudioapi_0.10         
##  [10] farver_2.0.1             graphlayouts_0.5.0       ggrepel_0.8.1           
##  [13] RSpectra_0.16-0          splines_3.6.1            knitr_1.26              
##  [16] heatmap.plus_1.3         polyclip_1.10-0          zeallot_0.1.0           
##  [19] jsonlite_1.6             alluvial_0.1-2           pheatmap_1.0.12         
##  [22] uwot_0.1.4               shiny_1.4.0              ggforce_0.3.1           
##  [25] ExPosition_2.8.23        compiler_3.6.1           dqrng_0.2.1             
##  [28] prettyGraphs_2.1.6       backports_1.1.5          fastmap_1.0.1           
##  [31] assertthat_0.2.1         Matrix_1.2-18            lazyeval_0.2.2          
##  [34] limma_3.42.0             later_1.0.0              tweenr_1.0.1            
##  [37] BiocSingular_1.2.0       htmltools_0.4.0          tools_3.6.1             
##  [40] rsvd_1.0.2               igraph_1.2.4.2           gtable_0.3.0            
##  [43] glue_1.3.1               GenomeInfoDbData_1.2.2   reshape2_1.4.3          
##  [46] dplyr_0.8.3              Rcpp_1.0.3               pkgdown_1.4.1           
##  [49] vctrs_0.2.0              crosstalk_1.0.0          DelayedMatrixStats_1.8.0
##  [52] ggraph_2.0.0             xfun_0.11                stringr_1.4.0           
##  [55] mime_0.7                 lifecycle_0.1.0          irlba_2.3.3             
##  [58] statmod_1.4.32           edgeR_3.28.0             zlibbioc_1.32.0         
##  [61] MASS_7.3-51.4            scales_1.1.0             tidygraph_1.1.2         
##  [64] promises_1.1.0           rhdf5_2.30.1             RColorBrewer_1.1-2      
##  [67] SNFtool_2.3.0            yaml_2.2.0               memoise_1.1.0           
##  [70] segmented_1.0-0          stringi_1.4.3            desc_1.2.0              
##  [73] randomForest_4.6-14      scran_1.14.5             rlang_0.4.2             
##  [76] pkgconfig_2.0.3          bitops_1.0-6             evaluate_0.14           
##  [79] lattice_0.20-38          purrr_0.3.3              Rhdf5lib_1.8.0          
##  [82] labeling_0.3             htmlwidgets_1.5.1        cowplot_1.0.0           
##  [85] tidyselect_0.2.5         plyr_1.8.4               magrittr_1.5            
##  [88] R6_2.4.1                 withr_2.1.2              pillar_1.4.2            
##  [91] mixtools_1.1.0           survival_3.1-8           RCurl_1.95-4.12         
##  [94] tibble_2.1.3             crayon_1.3.4             rmarkdown_1.18          
##  [97] viridis_0.5.1            locfit_1.5-9.1           grid_3.6.1              
## [100] FNN_1.1.3                propr_4.1.6              digest_0.6.23           
## [103] xtable_1.8-4             httpuv_1.5.2             tidyr_1.0.0             
## [106] dbscan_1.1-5             RcppParallel_4.4.4       munsell_0.5.0           
## [109] beeswarm_0.2.3           viridisLite_0.3.0        vipor_0.4.5</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#detecting-both-cross--and-within-sample-doublets-using-citefuse">Detecting both cross- and within-sample doublets using <code>CiteFuse</code></a><ul class="nav nav-pills nav-stacked">
<li><a href="#hto-normalisation-and-visualisation">HTO Normalisation and Visualisation</a></li>
      <li><a href="#doublet-identification-cross-sample">Doublet Identification (cross sample)</a></li>
      <li><a href="#doublet-identification-within-samples">Doublet Identification (within samples)</a></li>
      </ul>
</li>
      <li>
<a href="#clustering">Clustering</a><ul class="nav nav-pills nav-stacked">
<li><a href="#performing-snf">Performing SNF</a></li>
      <li><a href="#performing-spectral-clustering">Performing spectral clustering</a></li>
      <li><a href="#visualisation">Visualisation</a></li>
      <li><a href="#louvain-clustering">Louvain Clustering</a></li>
      </ul>
</li>
      <li>
<a href="#differential-expression-analysis">Differential Expression Analysis</a><ul class="nav nav-pills nav-stacked">
<li><a href="#exploration-of-features-expression">Exploration of features expression</a></li>
      <li><a href="#perform-de-analysis-using-wilcoxon-rank-sum-test">Perform DE analysis using Wilcoxon Rank Sum test</a></li>
      <li><a href="#visualising-de-results">Visualising DE results</a></li>
      </ul>
</li>
      <li><a href="#adt-importance-evaluation">ADT importance evaluation</a></li>
      <li><a href="#gene---adt-network">Gene - ADT network</a></li>
      <li><a href="#rna-ligand---adt-receptor-analysis">RNA Ligand - ADT Receptor Analysis</a></li>
      <li><a href="#sessioninfo">SessionInfo</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Yingxin Lin, Hani Kim.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
