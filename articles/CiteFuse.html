<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CiteFuse: getting started â€¢ CiteFuse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="CiteFuse: getting started">
<meta property="og:description" content="CiteFuse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CiteFuse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Getting started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CiteFuse.html">Getting started with CiteFuse</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SydneyBioX/CiteFuse">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="CiteFuse_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="CiteFuse_files/jquery-1.12.4/jquery.min.js"></script><link href="CiteFuse_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="CiteFuse_files/datatables-binding-0.13/datatables.js"></script><link href="CiteFuse_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="CiteFuse_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="CiteFuse_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="CiteFuse_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="CiteFuse_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>CiteFuse: getting started</h1>
            
            <h4 class="date">13 April 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/SydneyBioX/CiteFuse/blob/master/vignettes/CiteFuse.Rmd"><code>vignettes/CiteFuse.Rmd</code></a></small>
      <div class="hidden name"><code>CiteFuse.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>CiteFuse</code> is a computational framework that implements a suite of methods and tools for CITE-seq data from pre-processing through to integrative analytics. This includes doublet detection, network-based modality integration, cell type clustering, differential RNA and protein expression analysis, ADT evaluation, ligand-receptor interaction analysis, and interactive web-based visualisation of the analyses. This vignette demostrates the usage of <code>CiteFuse</code> by using a subset data of CITE-seq data from human PBMCs as an example (Mimitou et al., 2019).</p>
<p>First, install <code>CiteFuse</code> using <code>BiocManager</code>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"BiocManager"</span>, <span class="kw">quietly</span> <span class="kw">=</span> <span class="fl">TRUE</span>)) {
 <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)
}
<span class="kw pkg">BiocManager</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"CiteFuse"</span>)</pre></body></html></div>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">CiteFuse</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">scater</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">SingleCellExperiment</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DT</span>)</pre></body></html></div>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"CITEseq_example"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"CiteFuse"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">CITEseq_example</span>)</pre></body></html></div>
<pre><code>## [1] "RNA" "ADT" "HTO"</code></pre>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">CITEseq_example</span>, <span class="no">dim</span>)</pre></body></html></div>
<pre><code>## $RNA
## [1] 19521   500
## 
## $ADT
## [1]  49 500
## 
## $HTO
## [1]   4 500</code></pre>
<p>Here, we start from a list of three matrices of UMI, ADT and HTO count, which have common cell names. The <code>preprocessing</code> function will utilise the three matrices and its common cell names to create a <code>SingleCellExperiment</code> object, which stores RNA data in an <code>assay</code> and <code>ADT</code> and <code>HTO</code> data in <code>altExp</code> slot.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/preprocessing.html">preprocessing</a></span>(<span class="no">CITEseq_example</span>)
<span class="no">sce_citeseq</span></pre></body></html></div>
<pre><code>## class: SingleCellExperiment 
## dim: 19521 500 
## metadata(0):
## assays(1): counts
## rownames(19521): hg19_AL627309.1 hg19_AL669831.5 ... hg19_MT-ND6
##   hg19_MT-CYB
## rowData names(0):
## colnames(500): AAGCCGCGTTGTCTTT GATCGCGGTTATCGGT ... TTGGCAACACTAGTAC
##   GCTGCGAGTTGTGGCC
## colData names(0):
## reducedDimNames(0):
## altExpNames(2): ADT HTO</code></pre>
</div>
<div id="detecting-both-cross--and-within-sample-doublets-using-citefuse" class="section level1">
<h1 class="hasAnchor">
<a href="#detecting-both-cross--and-within-sample-doublets-using-citefuse" class="anchor"></a>Detecting both cross- and within-sample doublets using <code>CiteFuse</code>
</h1>
<div id="hto-normalisation-and-visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#hto-normalisation-and-visualisation" class="anchor"></a>HTO Normalisation and Visualisation</h2>
<p>The function <code>normaliseExprs</code> is used to scale the alternative expression. Here, we used it to perform log-transformation of the <code>HTO</code> count, by setting <code>transform = "log"</code>.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(<span class="kw">sce</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>,
                              <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"HTO"</span>,
                              <span class="kw">transform</span> <span class="kw">=</span> <span class="st">"log"</span>)</pre></body></html></div>
<p>Then we can perform dimension reduction on the <code>HTO</code> count by using <code>runTSNE</code> or <code>runUMAP</code>, then use <code>visualiseDim</code> function to visualise the reduced dimension plot.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="kw pkg">scater</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runTSNE.html">runTSNE</a></span>(<span class="no">sce_citeseq</span>,
                               <span class="kw">altexp</span> <span class="kw">=</span> <span class="st">"HTO"</span>,
                               <span class="kw">name</span> <span class="kw">=</span> <span class="st">"TSNE_HTO"</span>,
                               <span class="kw">pca</span> <span class="kw">=</span> <span class="fl">TRUE</span>)


<span class="fu"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(<span class="no">sce_citeseq</span>,
             <span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"TSNE_HTO"</span>) + <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"tSNE (HTO)"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="kw pkg">scater</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runUMAP.html">runUMAP</a></span>(<span class="no">sce_citeseq</span>,
                               <span class="kw">altexp</span> <span class="kw">=</span> <span class="st">"HTO"</span>,
                               <span class="kw">name</span> <span class="kw">=</span> <span class="st">"UMAP_HTO"</span>)


<span class="fu"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(<span class="no">sce_citeseq</span>,
             <span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"UMAP_HTO"</span>) + <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"UMAP (HTO)"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-6-2.png" width="576"></p>
</div>
<div id="doublet-identification-cross-sample" class="section level2">
<h2 class="hasAnchor">
<a href="#doublet-identification-cross-sample" class="anchor"></a>Doublet Identification (cross sample)</h2>
<p>We first identify the cross-sample doublets via the <code>crossSampleDoublets</code> function.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/crossSampleDoublets.html">crossSampleDoublets</a></span>(<span class="no">sce_citeseq</span>)</pre></body></html></div>
<pre><code>## number of iterations= 20 
## number of iterations= 24 
## number of iterations= 46 
## number of iterations= 50</code></pre>
<p>The results of the cross sample doublets are then saved in <code>colData</code> as <code>doubletClassify_between_label</code> and <code>doubletClassify_between_class</code>.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">sce_citeseq</span>$<span class="no">doubletClassify_between_label</span>)</pre></body></html></div>
<pre><code>## 
##                 1                 2                 3                 4 
##               115               121                92               129 
## doublet/multiplet 
##                43</code></pre>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">sce_citeseq</span>$<span class="no">doubletClassify_between_class</span>)</pre></body></html></div>
<pre><code>## 
## doublet/multiplet           Singlet 
##                43               457</code></pre>
<p>We can then highlight the cross-sample doublets in our tSNE plot of HTO count.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(<span class="no">sce_citeseq</span>,
             <span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"TSNE_HTO"</span>,
             <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"doubletClassify_between_label"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<p>Furthermore, <code>plotHTO</code> function allows us to plot the pairwise scatter HTO count.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="../reference/plotHTO.html">plotHTO</a></span>(<span class="no">sce_citeseq</span>, <span class="fl">1</span>:<span class="fl">4</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
</div>
<div id="doublet-identification-within-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#doublet-identification-within-samples" class="anchor"></a>Doublet Identification (within samples)</h2>
<p>We then identify the within-sample doublets via the <code>withinSampleDoublets</code> function.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/withinSampleDoublets.html">withinSampleDoublets</a></span>(<span class="no">sce_citeseq</span>,
                                    <span class="kw">minPts</span> <span class="kw">=</span> <span class="fl">10</span>)</pre></body></html></div>
<p>The results of the cross sample doublets are then saved in the <code>colData</code> as <code>doubletClassify_within_label</code> and <code>doubletClassify_within_class</code>.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">sce_citeseq</span>$<span class="no">doubletClassify_within_label</span>)</pre></body></html></div>
<pre><code>## 
##  Doublets(Within)_1  Doublets(Within)_2  Doublets(Within)_3  Doublets(Within)_4 
##                   3                   7                   4                   6 
## NotDoublets(Within) 
##                 480</code></pre>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">sce_citeseq</span>$<span class="no">doubletClassify_within_class</span>)</pre></body></html></div>
<pre><code>## 
## Doublet Singlet 
##      20     480</code></pre>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(<span class="no">sce_citeseq</span>,
             <span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"TSNE_HTO"</span>,
             <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"doubletClassify_within_label"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
<p>Finally, we can filter out the doublets cells (both within and between batches) for the downstream analysis.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="no">sce_citeseq</span>[, <span class="no">sce_citeseq</span>$<span class="no">doubletClassify_within_class</span> <span class="kw">==</span> <span class="st">"Singlet"</span> <span class="kw">&amp;</span> <span class="no">sce_citeseq</span>$<span class="no">doubletClassify_between_class</span> <span class="kw">==</span> <span class="st">"Singlet"</span>]
<span class="no">sce_citeseq</span></pre></body></html></div>
<pre><code>## class: SingleCellExperiment 
## dim: 19521 437 
## metadata(3): doubletClassify_between_threshold
##   doubletClassify_between_resultsMat doubletClassify_within_resultsMat
## assays(1): counts
## rownames(19521): hg19_AL627309.1 hg19_AL669831.5 ... hg19_MT-ND6
##   hg19_MT-CYB
## rowData names(0):
## colnames(437): GATCGCGGTTATCGGT GGCTGGTAGAGGTTAT ... TTGGCAACACTAGTAC
##   GCTGCGAGTTGTGGCC
## colData names(5): doubletClassify_between_label
##   doubletClassify_between_class nUMI doubletClassify_within_label
##   doubletClassify_within_class
## reducedDimNames(2): TSNE_HTO UMAP_HTO
## altExpNames(2): ADT HTO</code></pre>
</div>
</div>
<div id="clustering" class="section level1">
<h1 class="hasAnchor">
<a href="#clustering" class="anchor"></a>Clustering</h1>
<div id="performing-snf" class="section level2">
<h2 class="hasAnchor">
<a href="#performing-snf" class="anchor"></a>Performing SNF</h2>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="kw pkg">scater</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/logNormCounts.html">logNormCounts</a></span>(<span class="no">sce_citeseq</span>)
<span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>, <span class="kw">transform</span> <span class="kw">=</span> <span class="st">"log"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(<span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/CiteFuse.html">CiteFuse</a></span>(<span class="no">sce_citeseq</span>))</pre></body></html></div>
<pre><code>## Calculating affinity matrix 
## Performing SNF</code></pre>
<pre><code>##    user  system elapsed 
##   2.809   0.117   2.927</code></pre>
</div>
<div id="performing-spectral-clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#performing-spectral-clustering" class="anchor"></a>Performing spectral clustering</h2>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">SNF_W_clust</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"SNF_W"</span>]], <span class="kw">K</span> <span class="kw">=</span> <span class="fl">20</span>)</pre></body></html></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 20 dimensions</code></pre>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">SNF_W_clust</span>$<span class="no">eigen_values</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="no">SNF_W_clust</span>$<span class="no">eigen_values</span>)))</pre></body></html></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">SNF_W_clust</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"SNF_W"</span>]], <span class="kw">K</span> <span class="kw">=</span> <span class="fl">5</span>)</pre></body></html></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">sce_citeseq</span>$<span class="no">SNF_W_clust</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">SNF_W_clust</span>$<span class="no">labels</span>)

<span class="no">SNF_W1_clust</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"ADT_W"</span>]], <span class="kw">K</span> <span class="kw">=</span> <span class="fl">5</span>)</pre></body></html></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">sce_citeseq</span>$<span class="no">ADT_clust</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">SNF_W1_clust</span>$<span class="no">labels</span>)

<span class="no">SNF_W2_clust</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"RNA_W"</span>]], <span class="kw">K</span> <span class="kw">=</span> <span class="fl">5</span>)</pre></body></html></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">sce_citeseq</span>$<span class="no">RNA_clust</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">SNF_W2_clust</span>$<span class="no">labels</span>)</pre></body></html></div>
</div>
<div id="visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#visualisation" class="anchor"></a>Visualisation</h2>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/reducedDimSNF.html">reducedDimSNF</a></span>(<span class="no">sce_citeseq</span>,
                             <span class="kw">method</span> <span class="kw">=</span> <span class="st">"tSNE"</span>,
                             <span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"tSNE_joint"</span>)

<span class="no">g1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"tSNE_joint"</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"SNF_W_clust"</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"tSNE (SNF clustering)"</span>)
<span class="no">g2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"tSNE_joint"</span>,  <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"ADT_clust"</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"tSNE (ADT clustering)"</span>)
<span class="no">g3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"tSNE_joint"</span>,  <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"RNA_clust"</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"tSNE (RNA clustering)"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gridExtra</span>)
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">g3</span>, <span class="no">g2</span>, <span class="no">g1</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="no">g1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"tSNE_joint"</span>,
                   <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"hg19_CD8A"</span>,
                   <span class="kw">data_from</span> <span class="kw">=</span> <span class="st">"assay"</span>,
                   <span class="kw">assay_name</span> <span class="kw">=</span> <span class="st">"logcounts"</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"tSNE: hg19_CD8A (RNA expression)"</span>)
<span class="no">g2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(<span class="no">sce_citeseq</span>,<span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"tSNE_joint"</span>,
                   <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"CD8"</span>,
                   <span class="kw">data_from</span> <span class="kw">=</span> <span class="st">"altExp"</span>,
                   <span class="kw">altExp_assay_name</span> <span class="kw">=</span> <span class="st">"logcounts"</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"tSNE: CD8 (ADT expression)"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">g1</span>, <span class="no">g2</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div id="louvain-clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#louvain-clustering" class="anchor"></a>Louvain clustering</h2>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="no">SNF_W_louvain</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/igraphClustering.html">igraphClustering</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"louvain"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">SNF_W_louvain</span>)</pre></body></html></div>
<pre><code>## SNF_W_louvain
##  1  2  3  4  5  6  7  8  9 
## 30 38 80 29 90 37 52 29 52</code></pre>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="no">sce_citeseq</span>$<span class="no">SNF_W_louvain</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">SNF_W_louvain</span>)

<span class="fu"><a href="../reference/visualiseDim.html">visualiseDim</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">dimNames</span> <span class="kw">=</span> <span class="st">"tSNE_joint"</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"SNF_W_louvain"</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"tSNE (SNF louvain clustering)"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-19-1.png" width="768"></p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseKNN.html">visualiseKNN</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">colour_by</span> <span class="kw">=</span> <span class="st">"SNF_W_louvain"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-20-1.png" width="576"></p>
</div>
</div>
<div id="differential-expression-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#differential-expression-analysis" class="anchor"></a>Differential Expression Analysis</h1>
<div id="exploration-of-feature-expression" class="section level2">
<h2 class="hasAnchor">
<a href="#exploration-of-feature-expression" class="anchor"></a>Exploration of feature expression</h2>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(<span class="no">sce_citeseq</span>,
               <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"boxplot"</span>,
               <span class="kw">group_by</span> <span class="kw">=</span> <span class="st">"SNF_W_louvain"</span>,
               <span class="kw">feature_subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-21-1.png" width="768"></p>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(<span class="no">sce_citeseq</span>,
               <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"violin"</span>,
               <span class="kw">group_by</span> <span class="kw">=</span> <span class="st">"SNF_W_louvain"</span>,
               <span class="kw">feature_subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-21-2.png" width="768"></p>
<div class="sourceCode" id="cb51"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(<span class="no">sce_citeseq</span>,
               <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"jitter"</span>,
               <span class="kw">group_by</span> <span class="kw">=</span> <span class="st">"SNF_W_louvain"</span>,
               <span class="kw">feature_subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-21-3.png" width="768"></p>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(<span class="no">sce_citeseq</span>,
               <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"density"</span>,
               <span class="kw">group_by</span> <span class="kw">=</span> <span class="st">"SNF_W_louvain"</span>,
               <span class="kw">feature_subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD2"</span>, <span class="st">"hg19_CD4"</span>, <span class="st">"hg19_CD8A"</span>, <span class="st">"hg19_CD19"</span>))</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-21-4.png" width="768"></p>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(<span class="no">sce_citeseq</span>,
               <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>,
               <span class="kw">n</span> <span class="kw">=</span> <span class="fl">30</span>) +
  <span class="fu">coord_flip</span>()</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-22-1.png" width="768"></p>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(<span class="no">sce_citeseq</span>,
               <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>,
               <span class="kw">group_by</span> <span class="kw">=</span> <span class="st">"SNF_W_louvain"</span>,
               <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"violin"</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">5</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-23-1.png" width="768"></p>
<div class="sourceCode" id="cb55"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>,
               <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"jitter"</span>,
               <span class="kw">group_by</span> <span class="kw">=</span> <span class="st">"SNF_W_louvain"</span>,
               <span class="kw">feature_subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD2"</span>, <span class="st">"CD8"</span>, <span class="st">"CD4"</span>, <span class="st">"CD19"</span>))</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-23-2.png" width="768"></p>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>,
               <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"density"</span>,
               <span class="kw">group_by</span> <span class="kw">=</span> <span class="st">"SNF_W_louvain"</span>,
               <span class="kw">feature_subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD2"</span>, <span class="st">"CD8"</span>, <span class="st">"CD4"</span>, <span class="st">"CD19"</span>))</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-23-3.png" width="768"></p>
<div class="sourceCode" id="cb57"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>,
               <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"pairwise"</span>,
               <span class="kw">feature_subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD4"</span>, <span class="st">"CD8"</span>))</pre></body></html></div>
<pre><code>## number of iterations= 9 
## number of iterations= 17</code></pre>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-24-1.png" width="768"></p>
<div class="sourceCode" id="cb59"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprs.html">visualiseExprs</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>,
               <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"pairwise"</span>,
               <span class="kw">feature_subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD45RA"</span>, <span class="st">"CD4"</span>, <span class="st">"CD8"</span>), <span class="kw">threshold</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">4</span>, <span class="fl">3</span>))</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-24-2.png" width="768"></p>
</div>
<div id="perform-de-analysis-with-wilcoxon-rank-sum-test" class="section level2">
<h2 class="hasAnchor">
<a href="#perform-de-analysis-with-wilcoxon-rank-sum-test" class="anchor"></a>Perform DE Analysis with Wilcoxon Rank Sum test</h2>
<div id="for-rna-expression" class="section level3">
<h3 class="hasAnchor">
<a href="#for-rna-expression" class="anchor"></a>For RNA expression</h3>
<div class="sourceCode" id="cb60"><html><body><pre class="r"><span class="co"># DE will be performed for RNA if altExp_name = "none" </span>
<span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/DEgenes.html">DEgenes</a></span>(<span class="no">sce_citeseq</span>,
                       <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"none"</span>,
                       <span class="kw">group</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>$<span class="no">SNF_W_louvain</span>,
                       <span class="kw">return_all</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                       <span class="kw">exprs_pct</span> <span class="kw">=</span> <span class="fl">0.5</span>)


<span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/selectDEgenes.html">selectDEgenes</a></span>(<span class="no">sce_citeseq</span>,
                             <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"none"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"DE_res_RNA_filter"</span>]]),
                 <span class="kw">digits</span> <span class="kw">=</span> <span class="fl">2</span>))</pre></body></html></div>
<div id="htmlwidget-438b115ab5c09fb250fb" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-438b115ab5c09fb250fb">{"x":{"filter":"none","data":[["1.hg19_GZMK","1.hg19_KLRB1","1.hg19_DUSP2","1.hg19_IL7R","1.hg19_NCR3","1.hg19_CEBPD","1.hg19_KLRG1","1.hg19_CD69","1.hg19_LINC01871","1.hg19_IL32","2.hg19_CD8B","2.hg19_CMC1","2.hg19_CCL5","2.hg19_CD8A","2.hg19_GZMM","2.hg19_DUSP2","2.hg19_NDUFA6","2.hg19_HCST","2.hg19_RNF166","2.hg19_FYN","3.hg19_ZNF683","3.hg19_TRBV20-1","3.hg19_CD8A","3.hg19_FGFBP2","3.hg19_GZMH","3.hg19_CD8B","3.hg19_CCL5","3.hg19_CST7","3.hg19_KLRD1","3.hg19_CYTOR","4.hg19_CCR7","4.hg19_ACTN1","4.hg19_NELL2","4.hg19_PASK","4.hg19_MAL","4.hg19_CD8B","4.hg19_LEF1","4.hg19_PIK3IP1","4.hg19_LDLRAP1","4.hg19_PCED1B","5.hg19_LTB","5.hg19_TCF7","5.hg19_IL7R","5.hg19_LDHB","5.hg19_INPP4B","5.hg19_CD27","5.hg19_LEF1","5.hg19_NOSIP","5.hg19_SELL","5.hg19_CAMK4","6.hg19_FCN1","6.hg19_LYZ","6.hg19_SPI1","6.hg19_CYBB","6.hg19_HLA-DRA","6.hg19_S100A9","6.hg19_CD68","6.hg19_S100A8","6.hg19_CSTA","6.hg19_VCAN","7.hg19_GNLY","7.hg19_CCL5","7.hg19_GZMB","7.hg19_CTSW","7.hg19_NKG7","7.hg19_GZMH","7.hg19_IFITM2","7.hg19_KLRD1","7.hg19_CD8A","7.hg19_TYROBP","8.hg19_IL7R","8.hg19_S100A4","8.hg19_S100A10","8.hg19_IL32","8.hg19_EML4","8.hg19_FAM107B","8.hg19_RORA","8.hg19_CD2","8.hg19_TNFAIP3","8.hg19_GUK1","9.hg19_SH2D1B","9.hg19_KLRF1","9.hg19_CLIC3","9.hg19_FCER1G","9.hg19_MYOM2","9.hg19_TRDC","9.hg19_SPON2","9.hg19_TYROBP","9.hg19_IL2RB","9.hg19_KLRB1"],["2668"," 850","2126","2159","3396","3393","2878","3109","3983","3478","3257","3984","3217","4004","4452","5063","5205","4890","5330","5168","4890","6321","4268","5222","5277","7670","6396","6720","7320","8196","2449","2815","2907","3163","3115","2175","2384","2787","3260","3524","3917","5592","5443","5736","9061","9080","8530","7904","8680","9426","2400","2406","2409","2600"," 661","2808","3200","2825","3400","3400","2545","3656","4591","5072","4800","5220","4839","5452","5463","6141","2602","3100","3253","3434","3973","4176","4256","4141","4160","4118","3603","2742","3449","3498","2047","4272","2804","2748","3121","3143"],["7.8e-24","2.5e-23","1.1e-11","1.2e-10","1.6e-10","3.2e-10","9.2e-09","2.5e-07","7.5e-06","7.6e-05","8.8e-14","9.8e-10","2.0e-09","1.6e-07","4.5e-06","1.1e-04","1.7e-04","2.7e-04","2.9e-04","3.3e-04","9.3e-43","8.1e-37","1.2e-26","9.8e-23","8.4e-22","9.8e-17","2.9e-15","2.9e-14","7.9e-14","1.5e-13","3.0e-21","3.7e-19","8.1e-19","1.6e-18","1.4e-13","2.8e-13","5.0e-13","5.0e-11","1.5e-10","2.7e-10","3.7e-34","2.4e-31","3.1e-25","7.1e-22","2.0e-19","3.8e-19","4.7e-19","2.3e-16","2.9e-15","1.0e-14","4.5e-64","1.1e-61","1.3e-61","1.9e-61","9.1e-60","2.2e-56","1.3e-53","4.7e-52","4.8e-51","4.8e-51","3.1e-19","2.9e-14","7.3e-12","1.9e-10","4.8e-10","1.1e-09","1.4e-09","5.1e-09","6.9e-09","7.8e-09","3.9e-08","1.8e-05","4.5e-05","1.5e-04","4.2e-04","2.8e-03","3.2e-03","3.9e-03","4.1e-03","4.6e-03","7.0e-52","3.7e-37","4.7e-34","1.4e-33","1.6e-33","6.8e-31","1.4e-27","2.3e-27","8.4e-26","3.1e-24"],["7.8e-24","2.5e-23","1.1e-11","1.2e-10","1.6e-10","3.2e-10","9.2e-09","2.5e-07","7.5e-06","7.6e-05","8.8e-14","9.8e-10","2.0e-09","1.6e-07","4.5e-06","1.1e-04","1.7e-04","2.7e-04","2.9e-04","3.3e-04","9.3e-43","8.1e-37","1.2e-26","9.8e-23","8.4e-22","9.8e-17","2.9e-15","2.9e-14","7.9e-14","1.5e-13","3.0e-21","3.7e-19","8.1e-19","1.6e-18","1.4e-13","2.8e-13","5.0e-13","5.0e-11","1.5e-10","2.7e-10","3.7e-34","2.4e-31","3.1e-25","7.1e-22","2.0e-19","3.8e-19","4.7e-19","2.3e-16","2.9e-15","1.0e-14","4.5e-64","1.1e-61","1.3e-61","1.9e-61","9.1e-60","2.2e-56","1.3e-53","4.7e-52","4.8e-51","4.8e-51","3.1e-19","2.9e-14","7.3e-12","1.9e-10","4.8e-10","1.1e-09","1.4e-09","5.1e-09","6.9e-09","7.8e-09","3.9e-08","1.8e-05","4.5e-05","1.5e-04","4.2e-04","2.8e-03","3.2e-03","3.9e-03","4.1e-03","4.6e-03","7.0e-52","3.7e-37","4.7e-34","1.4e-33","1.6e-33","6.8e-31","1.4e-27","2.3e-27","8.4e-26","3.1e-24"],["0.1088","0.4686","0.5104","0.9285","0.1657","0.2075","0.4686","0.4013","0.2302","1.7839","0.3541","0.4049","2.0103","0.8258","0.5960","0.5444","0.3662","1.3533","0.3648","0.5329","0.0920","0.1043","0.6408","0.6099","0.7164","0.3141","1.8257","1.3502","0.6572","0.2635","0.0890","0.0690","0.0740","0.0513","0.1080","0.3614","0.2537","0.2096","0.1353","0.0991","0.5608","0.2284","0.7299","0.7113","0.1061","0.1245","0.1797","0.3680","0.3325","0.1754","0.0000","0.0016","0.0027","0.0000","0.0529","0.0020","0.0000","0.0079","0.0000","0.0000","2.3480","1.9339","0.9406","0.6517","2.1203","0.8427","1.6395","0.7225","0.7999","0.5668","0.9520","2.3277","1.2842","1.7878","0.3654","0.4598","0.4339","0.6678","0.6590","0.7686","0.0184","0.1293","0.0921","0.1812","0.2495","0.0941","0.2766","0.4647","0.2215","0.4411"],["0.92","2.80","1.69","2.53","0.81","0.94","1.28","1.07","0.69","2.67","1.36","1.44","3.78","1.75","1.23","1.09","0.77","1.96","0.77","0.99","1.15","1.49","2.09","1.93","2.07","1.01","3.67","2.64","1.56","0.92","0.82","0.65","0.56","0.51","0.60","1.57","1.09","0.86","0.66","0.46","2.36","1.19","2.23","1.79","0.63","0.60","0.81","1.06","1.03","0.64","1.83","2.74","1.14","0.81","2.84","2.53","0.74","2.81","1.04","1.50","5.13","3.87","2.19","1.52","3.88","1.87","2.54","1.56","1.69","1.36","2.26","3.32","2.00","2.65","0.85","0.80","0.82","1.07","1.17","1.14","0.91","1.22","1.42","1.71","1.81","0.96","1.78","2.11","1.34","2.02"],["0.0565","0.2285","0.3489","0.4251","0.1278","0.1351","0.2998","0.3464","0.1843","0.7617","0.2206","0.2431","0.6140","0.4185","0.4286","0.3609","0.3283","0.7569","0.3058","0.4110","0.0616","0.0448","0.3529","0.3305","0.3585","0.1793","0.5686","0.5490","0.3641","0.2297","0.0784","0.0686","0.0637","0.0515","0.0931","0.2304","0.1985","0.1838","0.1275","0.0980","0.2911","0.1671","0.3314","0.5072","0.1037","0.1037","0.1441","0.3055","0.2248","0.1585","0.0000","0.0025","0.0025","0.0000","0.0450","0.0025","0.0000","0.0075","0.0000","0.0000","0.5792","0.6000","0.4156","0.3844","0.6052","0.4078","0.8312","0.3974","0.4078","0.2208","0.4265","0.8946","0.7451","0.7672","0.3137","0.3824","0.3382","0.4853","0.4755","0.5784","0.0130","0.0935","0.0831","0.0779","0.1766","0.0597","0.1896","0.1818","0.1844","0.2000"],["0.63","0.97","0.90","0.93","0.57","0.57","0.83","0.77","0.53","1.00","0.76","0.66","1.00","0.89","0.76","0.66","0.55","0.92","0.55","0.66","0.71","0.60","0.94","0.89","0.93","0.66","1.00","0.99","0.82","0.59","0.66","0.59","0.59","0.52","0.59","0.79","0.76","0.72","0.55","0.52","0.93","0.79","0.96","0.87","0.51","0.52","0.59","0.72","0.66","0.56","0.68","0.68","0.68","0.65","0.92","0.62","0.57","0.62","0.54","0.54","1.00","1.00","0.92","0.83","1.00","0.87","0.98","0.83","0.85","0.65","0.93","1.00","0.97","0.93","0.59","0.62","0.59","0.72","0.69","0.79","0.65","0.81","0.69","0.73","0.88","0.63","0.81","0.94","0.79","0.87"],["0.58","0.74","0.55","0.51","0.44","0.43","0.53","0.42","0.35","0.24","0.54","0.41","0.39","0.48","0.33","0.30","0.22","0.16","0.25","0.25","0.65","0.56","0.58","0.56","0.57","0.48","0.43","0.44","0.46","0.36","0.58","0.52","0.52","0.47","0.49","0.56","0.56","0.54","0.42","0.42","0.64","0.62","0.62","0.36","0.41","0.42","0.44","0.42","0.43","0.40","0.68","0.67","0.67","0.65","0.87","0.62","0.57","0.61","0.54","0.54","0.42","0.40","0.51","0.44","0.39","0.46","0.15","0.43","0.44","0.43","0.50","0.11","0.22","0.16","0.27","0.24","0.25","0.24","0.21","0.21","0.64","0.71","0.61","0.65","0.71","0.57","0.62","0.76","0.60","0.67"],["0.58","0.74","0.55","0.51","0.44","0.43","0.53","0.42","0.35","0.24","0.54","0.41","0.39","0.48","0.33","0.30","0.22","0.16","0.25","0.25","0.65","0.56","0.58","0.56","0.57","0.48","0.43","0.44","0.46","0.36","0.58","0.52","0.52","0.47","0.49","0.56","0.56","0.54","0.42","0.42","0.64","0.62","0.62","0.36","0.41","0.42","0.44","0.42","0.43","0.40","0.68","0.67","0.67","0.65","0.87","0.62","0.57","0.61","0.54","0.54","0.42","0.40","0.51","0.44","0.39","0.46","0.15","0.43","0.44","0.43","0.50","0.11","0.22","0.16","0.27","0.24","0.25","0.24","0.21","0.21","0.64","0.71","0.61","0.65","0.71","0.57","0.62","0.76","0.60","0.67"],["hg19_GZMK","hg19_KLRB1","hg19_DUSP2","hg19_IL7R","hg19_NCR3","hg19_CEBPD","hg19_KLRG1","hg19_CD69","hg19_LINC01871","hg19_IL32","hg19_CD8B","hg19_CMC1","hg19_CCL5","hg19_CD8A","hg19_GZMM","hg19_DUSP2","hg19_NDUFA6","hg19_HCST","hg19_RNF166","hg19_FYN","hg19_ZNF683","hg19_TRBV20-1","hg19_CD8A","hg19_FGFBP2","hg19_GZMH","hg19_CD8B","hg19_CCL5","hg19_CST7","hg19_KLRD1","hg19_CYTOR","hg19_CCR7","hg19_ACTN1","hg19_NELL2","hg19_PASK","hg19_MAL","hg19_CD8B","hg19_LEF1","hg19_PIK3IP1","hg19_LDLRAP1","hg19_PCED1B","hg19_LTB","hg19_TCF7","hg19_IL7R","hg19_LDHB","hg19_INPP4B","hg19_CD27","hg19_LEF1","hg19_NOSIP","hg19_SELL","hg19_CAMK4","hg19_FCN1","hg19_LYZ","hg19_SPI1","hg19_CYBB","hg19_HLA-DRA","hg19_S100A9","hg19_CD68","hg19_S100A8","hg19_CSTA","hg19_VCAN","hg19_GNLY","hg19_CCL5","hg19_GZMB","hg19_CTSW","hg19_NKG7","hg19_GZMH","hg19_IFITM2","hg19_KLRD1","hg19_CD8A","hg19_TYROBP","hg19_IL7R","hg19_S100A4","hg19_S100A10","hg19_IL32","hg19_EML4","hg19_FAM107B","hg19_RORA","hg19_CD2","hg19_TNFAIP3","hg19_GUK1","hg19_SH2D1B","hg19_KLRF1","hg19_CLIC3","hg19_FCER1G","hg19_MYOM2","hg19_TRDC","hg19_SPON2","hg19_TYROBP","hg19_IL2RB","hg19_KLRB1"],["1","1","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","2","3","3","3","3","3","3","3","3","3","3","4","4","4","4","4","4","4","4","4","4","5","5","5","5","5","5","5","5","5","5","6","6","6","6","6","6","6","6","6","6","7","7","7","7","7","7","7","7","7","7","8","8","8","8","8","8","8","8","8","8","9","9","9","9","9","9","9","9","9","9"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>stats.W<\/th>\n      <th>pval<\/th>\n      <th>p.adjust<\/th>\n      <th>meanExprs.1<\/th>\n      <th>meanExprs.2<\/th>\n      <th>meanPct.1<\/th>\n      <th>meanPct.2<\/th>\n      <th>meanDiff<\/th>\n      <th>pctDiff<\/th>\n      <th>name<\/th>\n      <th>group<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="for-adt-count" class="section level3">
<h3 class="hasAnchor">
<a href="#for-adt-count" class="anchor"></a>For ADT count</h3>
<div class="sourceCode" id="cb61"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/DEgenes.html">DEgenes</a></span>(<span class="no">sce_citeseq</span>,
                       <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>,
                       <span class="kw">group</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>$<span class="no">SNF_W_louvain</span>,
                       <span class="kw">return_all</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                       <span class="kw">exprs_pct</span> <span class="kw">=</span> <span class="fl">0.5</span>)


<span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/selectDEgenes.html">selectDEgenes</a></span>(<span class="no">sce_citeseq</span>,
                             <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"DE_res_ADT_filter"</span>]]),
                 <span class="kw">digits</span> <span class="kw">=</span> <span class="fl">2</span>))</pre></body></html></div>
<div id="htmlwidget-5e6e47bda3984c3fef09" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5e6e47bda3984c3fef09">{"x":{"filter":"none","data":[["1.CD26 (Adenosine)","1.CD28","4","5.CD28","5.CD26 (Adenosine)","5.CD3","6.LAMP1","6.CD45RO","6.CD45","6.B220 (CD45R)","6.CD14","6.B7-H1 (PD-L1)","6.Siglec-8","6.PD-L1 (CD274)","6.TCRg","6.EpCAM (CD326)","9"],[" 2830"," 3124"," 4549"," 4114","10836","10830"," 1652"," 1660"," 2274"," 2366"," 3156"," 2859"," 2594"," 2604"," 2774"," 2860"," 3146"],["5.0e-08","7.3e-06","3.7e-02","2.6e-27","6.5e-07","6.8e-06","2.0e-15","3.0e-15","2.9e-13","2.0e-12","1.2e-11","1.7e-11","2.0e-11","4.1e-11","4.2e-11","8.1e-11","4.9e-17"],["5.0e-08","7.3e-06","3.7e-02","2.6e-27","6.5e-07","6.8e-06","2.0e-15","3.0e-15","2.9e-13","2.0e-12","1.2e-11","1.7e-11","2.0e-11","4.1e-11","4.2e-11","8.1e-11","4.9e-17"],["0.46","1.48","1.51","1.28","0.45","1.43","0.92","1.13","0.57","0.79","0.27","0.41","0.78","1.13","0.56","0.54","0.65"],["1.59","2.28","1.87","2.54","0.86","1.83","2.55","2.59","1.46","1.71","1.59","1.32","1.80","2.16","1.44","1.51","1.74"],["0.41","0.85","0.85","0.83","0.38","0.85","0.77","0.85","0.58","0.75","0.33","0.46","0.72","0.87","0.57","0.56","0.54"],["0.73","0.97","1.00","0.99","0.63","0.97","1.00","1.00","0.95","0.97","0.70","0.84","0.95","0.97","0.86","0.89","0.94"],["0.32","0.11","0.15","0.16","0.25","0.12","0.23","0.15","0.37","0.22","0.38","0.38","0.22","0.10","0.30","0.33","0.40"],["0.32","0.11","0.15","0.16","0.25","0.12","0.23","0.15","0.37","0.22","0.38","0.38","0.22","0.10","0.30","0.33","0.40"],["CD26 (Adenosine)","CD28","CD28","CD28","CD26 (Adenosine)","CD3","LAMP1","CD45RO","CD45","B220 (CD45R)","CD14","B7-H1 (PD-L1)","Siglec-8","PD-L1 (CD274)","TCRg","EpCAM (CD326)","CD366 (tim3)"],["1","1","4","5","5","5","6","6","6","6","6","6","6","6","6","6","9"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>stats.W<\/th>\n      <th>pval<\/th>\n      <th>p.adjust<\/th>\n      <th>meanExprs.1<\/th>\n      <th>meanExprs.2<\/th>\n      <th>meanPct.1<\/th>\n      <th>meanPct.2<\/th>\n      <th>meanDiff<\/th>\n      <th>pctDiff<\/th>\n      <th>name<\/th>\n      <th>group<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="visualising-de-results" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-de-results" class="anchor"></a>Visualising DE Results</h2>
<div id="circlepackplot" class="section level3">
<h3 class="hasAnchor">
<a href="#circlepackplot" class="anchor"></a>circlepackPlot</h3>
<div class="sourceCode" id="cb62"><html><body><pre class="r"><span class="no">rna_DEgenes</span> <span class="kw">&lt;-</span> <span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"DE_res_RNA_filter"</span>]]
<span class="no">adt_DEgenes</span> <span class="kw">&lt;-</span> <span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"DE_res_ADT_filter"</span>]]

<span class="no">rna_DEgenes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">rna_DEgenes</span>, <span class="kw">function</span>(<span class="no">x</span>){
  <span class="no">x</span>$<span class="no">name</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"hg19_"</span>, <span class="st">""</span>, <span class="no">x</span>$<span class="no">name</span>)
  <span class="no">x</span>})
<span class="fu"><a href="../reference/DEbubblePlot.html">DEbubblePlot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">RNA</span> <span class="kw">=</span> <span class="no">rna_DEgenes</span>, <span class="kw">ADT</span> <span class="kw">=</span> <span class="no">adt_DEgenes</span>))</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-27-1.png" width="960"></p>
</div>
<div id="decomparisonplot" class="section level3">
<h3 class="hasAnchor">
<a href="#decomparisonplot" class="anchor"></a>DEcomparisonPlot</h3>
<div class="sourceCode" id="cb63"><html><body><pre class="r"><span class="no">rna_list</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_CD4"</span>,
              <span class="st">"hg19_CD8A"</span>,
              <span class="st">"hg19_HLA-DRB1"</span>,
              <span class="st">"hg19_ITGAX"</span>,
              <span class="st">"hg19_NCAM1"</span>,
              <span class="st">"hg19_CD27"</span>,
              <span class="st">"hg19_CD19"</span>)

<span class="no">adt_list</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD4"</span>, <span class="st">"CD8"</span>, <span class="st">"MHCII (HLA-DR)"</span>, <span class="st">"CD11c"</span>, <span class="st">"CD56"</span>, <span class="st">"CD27"</span>, <span class="st">"CD19"</span>)

<span class="no">rna_DEgenes_all</span> <span class="kw">&lt;-</span> <span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"DE_res_RNA"</span>]]
<span class="no">adt_DEgenes_all</span> <span class="kw">&lt;-</span> <span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"DE_res_ADT"</span>]]

<span class="no">feature_list</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">RNA</span> <span class="kw">=</span> <span class="no">rna_list</span>, <span class="kw">ADT</span> <span class="kw">=</span> <span class="no">adt_list</span>)
<span class="no">de_list</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">RNA</span> <span class="kw">=</span> <span class="no">rna_DEgenes_all</span>, <span class="kw">ADT</span> <span class="kw">=</span> <span class="no">adt_DEgenes_all</span>)

<span class="fu"><a href="../reference/DEcomparisonPlot.html">DEcomparisonPlot</a></span>(<span class="kw">de_list</span> <span class="kw">=</span> <span class="no">de_list</span>,
                 <span class="kw">feature_list</span> <span class="kw">=</span> <span class="no">feature_list</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-28-1.png" width="960"></p>
</div>
</div>
</div>
<div id="adt-importance-evaluation" class="section level1">
<h1 class="hasAnchor">
<a href="#adt-importance-evaluation" class="anchor"></a>ADT Importance Evaluation</h1>
<div class="sourceCode" id="cb64"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">2020</span>)
<span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/importanceADT.html">importanceADT</a></span>(<span class="no">sce_citeseq</span>,
                             <span class="kw">group</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>$<span class="no">SNF_W_louvain</span>,
                             <span class="kw">subsample</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="fu"><a href="../reference/visImportance.html">visImportance</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"boxplot"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-29-1.png" width="768"></p>
<div class="sourceCode" id="cb65"><html><body><pre class="r"><span class="fu"><a href="../reference/visImportance.html">visImportance</a></span>(<span class="no">sce_citeseq</span>, <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"heatmap"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-29-2.png" width="768"></p>
<div class="sourceCode" id="cb66"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"importanceADT"</span>]], <span class="kw">decreasing</span> <span class="kw">=</span> <span class="fl">TRUE</span>)[<span class="fl">1</span>:<span class="fl">20</span>]</pre></body></html></div>
<pre><code>##               CD4               CD8              CD27               CD5 
##         30.558333         29.224077         27.691326         22.097058 
##               CD7      PECAM (CD31)             CD11b               CD2 
##         16.041289         13.495346         12.716874         12.241439 
##    MHCII (HLA-DR)              CD28              CD44 IL7Ralpha (CD127) 
##         10.332952         10.189411          9.006814          8.808518 
##         HLA-A,B,C             CD62L             CD11c            CD45RA 
##          6.961884          5.921209          5.678501          5.612525 
##      CD366 (tim3)               CD3              CD56      PD-1 (CD279) 
##          5.294986          5.263878          4.732472          4.427862</code></pre>
<p>Select the ADTs with scores greater than 5 and perform SNF again</p>
<div class="sourceCode" id="cb68"><html><body><pre class="r"><span class="no">subset_adt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"importanceADT"</span>]] <span class="kw">&gt;</span> <span class="fl">5</span>))
<span class="no">subset_adt</span></pre></body></html></div>
<pre><code>##  [1] "CD11b"             "CD11c"             "CD2"              
##  [4] "CD27"              "CD28"              "CD3"              
##  [7] "CD366 (tim3)"      "CD4"               "CD44"             
## [10] "CD45RA"            "CD5"               "CD62L"            
## [13] "CD7"               "CD8"               "HLA-A,B,C"        
## [16] "IL7Ralpha (CD127)" "MHCII (HLA-DR)"    "PECAM (CD31)"</code></pre>
<div class="sourceCode" id="cb70"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(<span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/CiteFuse.html">CiteFuse</a></span>(<span class="no">sce_citeseq</span>,
                                    <span class="kw">ADT_subset</span> <span class="kw">=</span> <span class="no">subset_adt</span>,
                                    <span class="kw">metadata_names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"W_SNF_adtSubset1"</span>,
                                                       <span class="st">"W_ADT_adtSubset1"</span>,
                                                       <span class="st">"W_RNA"</span>)))</pre></body></html></div>
<pre><code>## Calculating affinity matrix 
## Performing SNF</code></pre>
<pre><code>##    user  system elapsed 
##   1.765   0.050   1.816</code></pre>
<div class="sourceCode" id="cb73"><html><body><pre class="r"><span class="no">SNF_W_clust_adtSubset1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/spectralClustering.html">spectralClustering</a></span>(<span class="fu">metadata</span>(<span class="no">sce_citeseq</span>)<span class="kw">[[</span><span class="st">"W_SNF_adtSubset1"</span>]], <span class="kw">K</span> <span class="kw">=</span> <span class="fl">5</span>)</pre></body></html></div>
<pre><code>## Computing Spectral Clustering 
## Computing Diffusion Coordinates
## Used default value: 5 dimensions</code></pre>
<div class="sourceCode" id="cb75"><html><body><pre class="r"><span class="no">sce_citeseq</span>$<span class="no">SNF_W_clust_adtSubset1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">SNF_W_clust_adtSubset1</span>$<span class="no">labels</span>)


<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mclust</span>)
<span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span>(<span class="no">sce_citeseq</span>$<span class="no">SNF_W_clust_adtSubset1</span>, <span class="no">sce_citeseq</span>$<span class="no">SNF_W_clust</span>)</pre></body></html></div>
<pre><code>## [1] 0.9305236</code></pre>
</div>
<div id="gene---adt-network" class="section level1">
<h1 class="hasAnchor">
<a href="#gene---adt-network" class="anchor"></a>Gene - ADT network</h1>
<div class="sourceCode" id="cb77"><html><body><pre class="r"><span class="no">RNA_feature_subset</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">rna_DEgenes_all</span>, <span class="st">"[["</span>, <span class="st">"name"</span>))))
<span class="no">ADT_feature_subset</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">adt_DEgenes_all</span>, <span class="st">"[["</span>, <span class="st">"name"</span>))))

<span class="fu"><a href="../reference/geneADTnetwork.html">geneADTnetwork</a></span>(<span class="no">sce_citeseq</span>,
               <span class="kw">RNA_feature_subset</span> <span class="kw">=</span> <span class="no">RNA_feature_subset</span>,
               <span class="kw">ADT_feature_subset</span> <span class="kw">=</span> <span class="no">ADT_feature_subset</span>,
               <span class="kw">cor_method</span> <span class="kw">=</span> <span class="st">"pearson"</span>,
               <span class="kw">network_layout</span> <span class="kw">=</span> <span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/igraph/man/layout_with_fr.html">layout_with_fr</a></span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-31-1.png" width="768"></p>
<pre><code>## IGRAPH 870354f UN-B 72 134 -- 
## + attr: name (v/c), label (v/c), class (v/c), type (v/l), shape (v/c),
## | color (v/c), size (v/n), label.cex (v/n), label.color (v/c), value
## | (e/n), color (e/c), weights (e/n)
## + edges from 870354f (vertex names):
##  [1] RNA_hg19_IL7R  --ADT_CD28             
##  [2] RNA_hg19_LTB   --ADT_CD28             
##  [3] RNA_hg19_NKG7  --ADT_CD28             
##  [4] RNA_hg19_CST7  --ADT_CD28             
##  [5] RNA_hg19_GNLY  --ADT_CD28             
##  [6] RNA_hg19_CCL5  --ADT_CD28             
## + ... omitted several edges</code></pre>
</div>
<div id="rna-ligand---adt-receptor-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#rna-ligand---adt-receptor-analysis" class="anchor"></a>RNA Ligand - ADT Receptor Analysis</h1>
<div class="sourceCode" id="cb79"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"lr_pair_subset"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"CiteFuse"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">lr_pair_subset</span>)</pre></body></html></div>
<pre><code>##      [,1]          [,2]   
## [1,] "hg19_IL17RA" "CD45" 
## [2,] "hg19_FAS"    "CD11b"
## [3,] "hg19_GZMK"   "CD62L"
## [4,] "hg19_CD40LG" "CD11b"
## [5,] "hg19_FLT3LG" "CD62L"
## [6,] "hg19_GZMA"   "CD19"</code></pre>
<div class="sourceCode" id="cb81"><html><body><pre class="r"><span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(<span class="kw">sce</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>,
                              <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>,
                              <span class="kw">transform</span> <span class="kw">=</span> <span class="st">"zi_minMax"</span>)

<span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/normaliseExprs.html">normaliseExprs</a></span>(<span class="kw">sce</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>,
                              <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"none"</span>,
                              <span class="kw">exprs_value</span> <span class="kw">=</span> <span class="st">"logcounts"</span>,
                              <span class="kw">transform</span> <span class="kw">=</span> <span class="st">"minMax"</span>)

<span class="no">sce_citeseq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ligandReceptorTest.html">ligandReceptorTest</a></span>(<span class="kw">sce</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>,
                                  <span class="kw">ligandReceptor_list</span> <span class="kw">=</span> <span class="no">lr_pair_subset</span>,
                                  <span class="kw">cluster</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>$<span class="no">SNF_W_louvain</span>,
                                  <span class="kw">RNA_exprs_value</span> <span class="kw">=</span> <span class="st">"minMax"</span>,
                                  <span class="kw">use_alt_exp</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                                  <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>,
                                  <span class="kw">altExp_exprs_value</span> <span class="kw">=</span> <span class="st">"zi_minMax"</span>,
                                  <span class="kw">num_permute</span> <span class="kw">=</span> <span class="fl">1000</span>)</pre></body></html></div>
<pre><code>## 100 ......200 ......300 ......400 ......500 ......600 ......700 ......800 ......900 ......1000 ......</code></pre>
<div class="sourceCode" id="cb83"><html><body><pre class="r"><span class="fu"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(<span class="no">sce_citeseq</span>,
                  <span class="kw">type</span> <span class="kw">=</span> <span class="st">"pval_heatmap"</span>,
                  <span class="kw">receptor_type</span> <span class="kw">=</span> <span class="st">"ADT"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-33-1.png" width="768"></p>
<div class="sourceCode" id="cb84"><html><body><pre class="r"><span class="fu"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(<span class="no">sce_citeseq</span>,
                  <span class="kw">type</span> <span class="kw">=</span> <span class="st">"pval_dotplot"</span>,
                  <span class="kw">receptor_type</span> <span class="kw">=</span> <span class="st">"ADT"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-34-1.png" width="576"></p>
<div class="sourceCode" id="cb85"><html><body><pre class="r"><span class="fu"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(<span class="no">sce_citeseq</span>,
                  <span class="kw">type</span> <span class="kw">=</span> <span class="st">"group_network"</span>,
                  <span class="kw">receptor_type</span> <span class="kw">=</span> <span class="st">"ADT"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-35-1.png" width="768"></p>
<div class="sourceCode" id="cb86"><html><body><pre class="r"><span class="fu"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(<span class="no">sce_citeseq</span>,
                  <span class="kw">type</span> <span class="kw">=</span> <span class="st">"group_heatmap"</span>,
                  <span class="kw">receptor_type</span> <span class="kw">=</span> <span class="st">"ADT"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-36-1.png" width="768"></p>
<div class="sourceCode" id="cb87"><html><body><pre class="r"><span class="fu"><a href="../reference/visLigandReceptor.html">visLigandReceptor</a></span>(<span class="no">sce_citeseq</span>,
                  <span class="kw">type</span> <span class="kw">=</span> <span class="st">"lr_network"</span>,
                  <span class="kw">receptor_type</span> <span class="kw">=</span> <span class="st">"ADT"</span>)</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-37-1.png" width="768"></p>
</div>
<div id="between-sample-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#between-sample-analysis" class="anchor"></a>Between-sample Analysis</h1>
<p>Here we will jointly analyse the current PBMC CITE-seq data, taken from healthy human donors, and another subset of CITE-seq data from patients with cutaneous T-cell lymphoma (CTCL), again from Mimitou et al. (2019). The data <code>sce_ctcl_subset</code> provided in our <code>CiteFuse</code> package already contain the clustering information.</p>
<div class="sourceCode" id="cb88"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"sce_ctcl_subset"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"CiteFuse"</span>)</pre></body></html></div>
<p>To visualise and compare gene or protein expression data, we can use <code>visualiseExprsList</code> function.</p>
<div class="sourceCode" id="cb89"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprsList.html">visualiseExprsList</a></span>(<span class="kw">sce_list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">control</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>,
                                   <span class="kw">ctcl</span> <span class="kw">=</span> <span class="no">sce_ctcl_subset</span>),
                   <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"boxplot"</span>,
                   <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"none"</span>,
                   <span class="kw">exprs_value</span> <span class="kw">=</span> <span class="st">"logcounts"</span>,
                   <span class="kw">feature_subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"hg19_S100A10"</span>, <span class="st">"hg19_CD8A"</span>),
                   <span class="kw">group_by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SNF_W_louvain"</span>, <span class="st">"SNF_W_louvain"</span>))</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
<div class="sourceCode" id="cb90"><html><body><pre class="r"><span class="fu"><a href="../reference/visualiseExprsList.html">visualiseExprsList</a></span>(<span class="kw">sce_list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">control</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>,
                                   <span class="kw">ctcl</span> <span class="kw">=</span> <span class="no">sce_ctcl_subset</span>),
                   <span class="kw">plot</span> <span class="kw">=</span> <span class="st">"boxplot"</span>,
                   <span class="kw">altExp_name</span> <span class="kw">=</span> <span class="st">"ADT"</span>,
                   <span class="kw">feature_subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD19"</span>, <span class="st">"CD8"</span>),
                   <span class="kw">group_by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SNF_W_louvain"</span>, <span class="st">"SNF_W_louvain"</span>))</pre></body></html></div>
<p><img src="CiteFuse_files/figure-html/unnamed-chunk-39-2.png" width="700"></p>
<p>We can then perform differential expression analysis of the RNA expression level across the two clusters that have high CD19 expression in ADT.</p>
<div class="sourceCode" id="cb91"><html><body><pre class="r"><span class="no">de_res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/DEgenesCross.html">DEgenesCross</a></span>(<span class="kw">sce_list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">control</span> <span class="kw">=</span> <span class="no">sce_citeseq</span>,
                                       <span class="kw">ctcl</span> <span class="kw">=</span> <span class="no">sce_ctcl_subset</span>),
                       <span class="kw">colData_name</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SNF_W_louvain"</span>, <span class="st">"SNF_W_louvain"</span>),
                       <span class="kw">group_to_test</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"2"</span>, <span class="st">"6"</span>))
<span class="no">de_res_filter</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/selectDEgenes.html">selectDEgenes</a></span>(<span class="kw">de_res</span> <span class="kw">=</span> <span class="no">de_res</span>)
<span class="no">de_res_filter</span></pre></body></html></div>
<pre><code>## $control
##            stats.W         pval     p.adjust meanExprs.1 meanExprs.2  meanPct.1
## hg19_NKG7     82.0 9.717299e-13 9.717299e-13  0.51066894   3.2333024 0.30232558
## hg19_CST7    138.0 5.875063e-12 5.875063e-12  0.22512314   2.2146495 0.13953488
## hg19_GNLY    186.0 8.935760e-12 8.935760e-12  0.07220401   2.7782587 0.02325581
## hg19_CCL5    124.0 2.418174e-11 2.418174e-11  1.04348029   3.7809281 0.37209302
## hg19_GZMH    258.0 1.807873e-10 1.807873e-10  0.00000000   1.4711399 0.00000000
## hg19_ITGB2   210.0 4.203966e-09 4.203966e-09  0.44185664   1.7346818 0.44186047
## hg19_KLRD1   322.5 5.000482e-08 5.000482e-08  0.09327555   1.0358615 0.09302326
## hg19_GZMA    284.5 5.732252e-08 5.732252e-08  0.32515702   1.5433119 0.18604651
## hg19_ZEB2    387.0 7.878997e-08 7.878997e-08  0.00000000   0.8211807 0.00000000
## hg19_CD99    274.0 1.679625e-07 1.679625e-07  0.58551572   1.5699157 0.46511628
##            meanPct.2  meanDiff   pctDiff       name   group
## hg19_NKG7  1.0000000 0.6976744 0.6976744  hg19_NKG7 control
## hg19_CST7  0.8947368 0.7552020 0.7552020  hg19_CST7 control
## hg19_GNLY  0.7894737 0.7662179 0.7662179  hg19_GNLY control
## hg19_CCL5  1.0000000 0.6279070 0.6279070  hg19_CCL5 control
## hg19_GZMH  0.6842105 0.6842105 0.6842105  hg19_GZMH control
## hg19_ITGB2 0.8684211 0.4265606 0.4265606 hg19_ITGB2 control
## hg19_KLRD1 0.6578947 0.5648715 0.5648715 hg19_KLRD1 control
## hg19_GZMA  0.8157895 0.6297430 0.6297430  hg19_GZMA control
## hg19_ZEB2  0.5263158 0.5263158 0.5263158  hg19_ZEB2 control
## hg19_CD99  0.8947368 0.4296206 0.4296206  hg19_CD99 control
## 
## $ctcl
##                stats.W         pval     p.adjust meanExprs.1 meanExprs.2
## hg19_RPS26         0.0 1.087530e-14 1.087530e-14  1.42819970    5.072471
## hg19_LTB         235.0 1.478865e-08 1.478865e-08  0.48566164    1.978730
## hg19_SELL        298.5 3.618421e-08 3.618421e-08  0.10674144    1.152572
## hg19_LEPROTL1    268.0 9.163954e-08 9.163954e-08  0.37427389    1.300745
## hg19_NOSIP       306.0 2.589055e-07 2.589055e-07  0.23412389    1.157235
## hg19_LINC02446   352.0 3.887845e-07 3.887845e-07  0.09889831    1.004083
## hg19_FOS         353.5 5.438707e-07 5.438707e-07  0.14088922    1.125337
## hg19_TMEM123     331.0 1.090629e-06 1.090629e-06  0.26112624    1.012034
## hg19_LDHB        325.0 2.344648e-06 2.344648e-06  0.70148411    1.588459
## hg19_NPM1        323.0 2.836125e-06 2.836125e-06  1.24903807    2.202268
##                 meanPct.1 meanPct.2  meanDiff   pctDiff           name group
## hg19_RPS26     0.84210526 1.0000000 0.1578947 0.1578947     hg19_RPS26  ctcl
## hg19_LTB       0.28947368 0.9069767 0.6175031 0.6175031       hg19_LTB  ctcl
## hg19_SELL      0.07894737 0.6976744 0.6187271 0.6187271      hg19_SELL  ctcl
## hg19_LEPROTL1  0.28947368 0.9069767 0.6175031 0.6175031  hg19_LEPROTL1  ctcl
## hg19_NOSIP     0.21052632 0.7674419 0.5569155 0.5569155     hg19_NOSIP  ctcl
## hg19_LINC02446 0.07894737 0.6279070 0.5489596 0.5489596 hg19_LINC02446  ctcl
## hg19_FOS       0.07894737 0.6511628 0.5722154 0.5722154       hg19_FOS  ctcl
## hg19_TMEM123   0.23684211 0.7674419 0.5305998 0.5305998   hg19_TMEM123  ctcl
## hg19_LDHB      0.50000000 0.8604651 0.3604651 0.3604651      hg19_LDHB  ctcl
## hg19_NPM1      0.68421053 0.9534884 0.2692778 0.2692778      hg19_NPM1  ctcl</code></pre>
</div>
<div id="sessioninfo" class="section level1">
<h1 class="hasAnchor">
<a href="#sessioninfo" class="anchor"></a>SessionInfo</h1>
<div class="sourceCode" id="cb93"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</pre></body></html></div>
<pre><code>## R Under development (unstable) (2020-03-25 r78063)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.4
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] mclust_5.4.6                gridExtra_2.3              
##  [3] DT_0.13                     scater_1.15.29             
##  [5] ggplot2_3.3.0               SingleCellExperiment_1.9.3 
##  [7] SummarizedExperiment_1.17.5 DelayedArray_0.13.12       
##  [9] matrixStats_0.56.0          Biobase_2.47.3             
## [11] GenomicRanges_1.39.3        GenomeInfoDb_1.23.16       
## [13] IRanges_2.21.8              S4Vectors_0.25.15          
## [15] BiocGenerics_0.33.3         CiteFuse_0.99.6            
## [17] BiocStyle_2.15.6           
## 
## loaded via a namespace (and not attached):
##   [1] ggbeeswarm_0.6.0         Rtsne_0.15               colorspace_1.4-1        
##   [4] RcppEigen_0.3.3.7.0      ellipsis_0.3.0           ggridges_0.5.2          
##   [7] rprojroot_1.3-2          XVector_0.27.2           BiocNeighbors_1.5.2     
##  [10] fs_1.4.1                 rstudioapi_0.11          farver_2.0.3            
##  [13] graphlayouts_0.6.0       ggrepel_0.8.2            RSpectra_0.16-0         
##  [16] fansi_0.4.1              splines_4.0.0            knitr_1.28              
##  [19] heatmap.plus_1.3         polyclip_1.10-0          jsonlite_1.6.1          
##  [22] alluvial_0.1-2           kernlab_0.9-29           uwot_0.1.8              
##  [25] pheatmap_1.0.12          ggforce_0.3.1            ExPosition_2.8.23       
##  [28] BiocManager_1.30.10      compiler_4.0.0           dqrng_0.2.1             
##  [31] prettyGraphs_2.1.6       backports_1.1.6          assertthat_0.2.1        
##  [34] Matrix_1.2-18            limma_3.43.5             cli_2.0.2               
##  [37] tweenr_1.0.1             BiocSingular_1.3.2       htmltools_0.4.0         
##  [40] tools_4.0.0              rsvd_1.0.3               igraph_1.2.5            
##  [43] gtable_0.3.0             glue_1.4.0               GenomeInfoDbData_1.2.2  
##  [46] reshape2_1.4.4           dplyr_0.8.5              Rcpp_1.0.4.6            
##  [49] pkgdown_1.5.1            vctrs_0.2.4              crosstalk_1.1.0.1       
##  [52] DelayedMatrixStats_1.9.1 ggraph_2.0.2             xfun_0.12               
##  [55] stringr_1.4.0            lifecycle_0.2.0          irlba_2.3.3             
##  [58] statmod_1.4.34           edgeR_3.29.1             zlibbioc_1.33.1         
##  [61] MASS_7.3-51.5            scales_1.1.0             tidygraph_1.1.2         
##  [64] rhdf5_2.31.10            RColorBrewer_1.1-2       SNFtool_2.3.0           
##  [67] yaml_2.2.1               memoise_1.1.0            segmented_1.1-0         
##  [70] stringi_1.4.6            desc_1.2.0               randomForest_4.6-14     
##  [73] scran_1.15.26            BiocParallel_1.21.2      rlang_0.4.5             
##  [76] pkgconfig_2.0.3          bitops_1.0-6             evaluate_0.14           
##  [79] lattice_0.20-41          purrr_0.3.3              Rhdf5lib_1.9.2          
##  [82] labeling_0.3             htmlwidgets_1.5.1        cowplot_1.0.0           
##  [85] tidyselect_1.0.0         plyr_1.8.6               magrittr_1.5            
##  [88] bookdown_0.18            R6_2.4.1                 withr_2.1.2             
##  [91] pillar_1.4.3             mixtools_1.2.0           survival_3.1-12         
##  [94] RCurl_1.98-1.1           tibble_3.0.0             crayon_1.3.4            
##  [97] rmarkdown_2.1            viridis_0.5.1            locfit_1.5-9.4          
## [100] grid_4.0.0               FNN_1.1.3                propr_4.2.6             
## [103] digest_0.6.25            tidyr_1.0.2              dbscan_1.1-5            
## [106] munsell_0.5.0            beeswarm_0.2.3           viridisLite_0.3.0       
## [109] vipor_0.4.5</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Yingxin Lin, Hani Kim.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
